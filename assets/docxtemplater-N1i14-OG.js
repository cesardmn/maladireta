import{r as _r,g as Br}from"./@xmldom-DOVMbaKB.js";var je={exports:{}},Ae,sr;function or(){if(sr)return Ae;sr=1;function E(L){return L[L.length-1]}function H(L){return L[0]}return Ae={last:E,first:H},Ae}var Ie,lr;function be(){if(lr)return Ie;lr=1;function E(a){"@babel/helpers - typeof";return E=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},E(a)}function H(a,n){var s=Object.keys(a);if(Object.getOwnPropertySymbols){var w=Object.getOwnPropertySymbols(a);n&&(w=w.filter(function(P){return Object.getOwnPropertyDescriptor(a,P).enumerable})),s.push.apply(s,w)}return s}function L(a){for(var n=1;n<arguments.length;n++){var s=arguments[n]!=null?arguments[n]:{};n%2?H(Object(s),!0).forEach(function(w){O(a,w,s[w])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(s)):H(Object(s)).forEach(function(w){Object.defineProperty(a,w,Object.getOwnPropertyDescriptor(s,w))})}return a}function O(a,n,s){return(n=_(n))in a?Object.defineProperty(a,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):a[n]=s,a}function _(a){var n=U(a,"string");return E(n)=="symbol"?n:n+""}function U(a,n){if(E(a)!="object"||!a)return a;var s=a[Symbol.toPrimitive];if(s!==void 0){var w=s.call(a,n);if(E(w)!="object")return w;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(a)}var M=or(),R=M.last,C=M.first;function q(a){this.name="GenericError",this.message=a,this.stack=new Error(a).stack}q.prototype=Error.prototype;function B(a){this.name="TemplateError",this.message=a,this.stack=new Error(a).stack}B.prototype=new q;function I(a){this.name="RenderingError",this.message=a,this.stack=new Error(a).stack}I.prototype=new q;function D(a){this.name="ScopeParserError",this.message=a,this.stack=new Error(a).stack}D.prototype=new q;function X(a){this.name="InternalError",this.properties={explanation:"InternalError"},this.message=a,this.stack=new Error(a).stack}X.prototype=new q;function V(a){this.name="APIVersionError",this.properties={explanation:"APIVersionError"},this.message=a,this.stack=new Error(a).stack}V.prototype=new q;function Z(a,n){var s=new V(a);throw s.properties=L({id:"api_version_error"},n),s}function m(a){var n=new B("Multi error");throw n.properties={errors:a,id:"multi_error",explanation:"The template has multiple errors"},n}function y(a){var n=new B("Unopened tag");return n.properties={xtag:R(a.xtag.split(" ")),id:"unopened_tag",context:a.xtag,offset:a.offset,lIndex:a.lIndex,explanation:'The tag beginning with "'.concat(a.xtag.substr(0,10),'" is unopened')},n}function b(a){var n=new B("Duplicate open tag, expected one open tag");return n.properties={xtag:C(a.xtag.split(" ")),id:"duplicate_open_tag",context:a.xtag,offset:a.offset,lIndex:a.lIndex,explanation:'The tag beginning with "'.concat(a.xtag.substr(0,10),'" has duplicate open tags')},n}function c(a){var n=new B("Duplicate close tag, expected one close tag");return n.properties={xtag:C(a.xtag.split(" ")),id:"duplicate_close_tag",context:a.xtag,offset:a.offset,lIndex:a.lIndex,explanation:'The tag ending with "'.concat(a.xtag.substr(0,10),'" has duplicate close tags')},n}function h(a){var n=new B("Unclosed tag");return n.properties={xtag:C(a.xtag.split(" ")).substr(1),id:"unclosed_tag",context:a.xtag,offset:a.offset,lIndex:a.lIndex,explanation:'The tag beginning with "'.concat(a.xtag.substr(0,10),'" is unclosed')},n}function f(a){var n=new B('No tag "'.concat(a.element,'" was found at the ').concat(a.position)),s=a.parsed[a.index];throw n.properties={id:"no_xml_tag_found_at_".concat(a.position),explanation:'No tag "'.concat(a.element,'" was found at the ').concat(a.position),offset:s.offset,part:s,parsed:a.parsed,index:a.index,element:a.element},n}function v(a){var n=a.tag,s=a.value,w=a.offset,P=new I("There are some XML corrupt characters");return P.properties={id:"invalid_xml_characters",xtag:n,value:s,offset:w,explanation:"There are some corrupt characters for the field ".concat(n)},P}function l(a){var n=a.tag,s=a.value,w=a.offset,P=new I("Non string values are not allowed for rawXML tags");return P.properties={id:"invalid_raw_xml_value",xtag:n,value:s,offset:w,explanation:"The value of the raw tag : '".concat(n,"' is not a string")},P}function i(a){var n=a.part,s=n.value,w=n.offset,P=a.id,z=P===void 0?"raw_tag_outerxml_invalid":P,J=a.message,$=J===void 0?"Raw tag not in paragraph":J,re=a.part,ae=a.explanation,p=ae===void 0?'The tag "'.concat(s,'" is not inside a paragraph'):ae;typeof p=="function"&&(p=p(re));var d=new B($);throw d.properties={id:z,explanation:p,rootError:a.rootError,xtag:s,offset:w,postparsed:a.postparsed,expandTo:a.expandTo,index:a.index},d}function u(a){var n=new B("Raw tag should be the only text in paragraph"),s=a.part.value;throw n.properties={id:"raw_xml_tag_should_be_only_text_in_paragraph",explanation:'The raw tag "'.concat(s,'" should be the only text in this paragraph. This means that this tag should not be surrounded by any text or spaces.'),xtag:s,offset:a.part.offset,paragraphParts:a.paragraphParts},n}function x(a){var n=a.location,s=a.offset,w=a.square,P=n==="start"?"unclosed":"unopened",z=n==="start"?"Unclosed":"Unopened",J=new B("".concat(z," loop")),$=a.value;return J.properties={id:"".concat(P,"_loop"),explanation:'The loop with tag "'.concat($,'" is ').concat(P),xtag:$,offset:s},w&&(J.properties.square=w),J}function S(a,n){var s=new B("Unbalanced loop tag"),w=n[0].part.value,P=n[1].part.value,z=a[0].part.value,J=a[1].part.value;return s.properties={id:"unbalanced_loop_tags",explanation:"Unbalanced loop tags {#".concat(w,"}{/").concat(P,"}{#").concat(z,"}{/").concat(J,"}"),offset:[n[0].part.offset,a[1].part.offset],lastPair:{left:n[0].part.value,right:n[1].part.value},pair:{left:a[0].part.value,right:a[1].part.value}},s}function j(a){var n=a.tags,s=new B("Closing tag does not match opening tag");return s.properties={id:"closing_tag_does_not_match_opening_tag",explanation:'The tag "'.concat(n[0].value,'" is closed by the tag "').concat(n[1].value,'"'),openingtag:C(n).value,offset:[C(n).offset,R(n).offset],closingtag:R(n).value},s}function ee(a){var n=a.tag,s=a.rootError,w=a.offset,P=new D("Scope parser compilation failed");return P.properties={id:"scopeparser_compilation_failed",offset:w,xtag:n,explanation:'The scope parser for the tag "'.concat(n,'" failed to compile'),rootError:s},P}function Q(a){var n=a.tag,s=a.scope,w=a.error,P=a.offset,z=new D("Scope parser execution failed");return z.properties={id:"scopeparser_execution_failed",explanation:"The scope parser for the tag ".concat(n," failed to execute"),scope:s,offset:P,xtag:n,rootError:w},z}function G(a){var n=a.tag,s=a.offset,w=new B('The position of the loop tags "'.concat(n,'" would produce invalid XML'));return w.properties={xtag:n,id:"loop_position_invalid",explanation:'The tags "'.concat(n,'" are misplaced in the document, for example one of them is in a table and the other one outside the table'),offset:s},w}function W(a,n){var s='Unimplemented tag type "'.concat(a.type,'"');a.module&&(s+=' "'.concat(a.module,'"'));var w=new B(s);throw w.properties={part:a,index:n,id:"unimplemented_tag_type"},w}function ne(){var a=new X("Malformed xml");throw a.properties={explanation:"The template contains malformed xml",id:"malformed_xml"},a}function ie(){var a=new X("You must run `.compile()` before running `.resolveData()`");throw a.properties={id:"resolve_before_compile",explanation:"You must run `.compile()` before running `.resolveData()`"},a}function se(){var a=new X("You should not call .render on a document that had compilation errors");throw a.properties={id:"render_on_invalid_template",explanation:"You should not call .render on a document that had compilation errors"},a}function ue(){var a=new X("You should not call .render twice on the same docxtemplater instance");throw a.properties={id:"render_twice",explanation:"You should not call .render twice on the same docxtemplater instance"},a}function fe(a){var n=Object.keys(a.files).slice(0,10),s="";n.length===0?s="Empty zip file":s="Zip file contains : ".concat(n.join(","));var w=new X("The filetype for this file could not be identified, is this file corrupted ? ".concat(s));throw w.properties={id:"filetype_not_identified",explanation:"The filetype for this file could not be identified, is this file corrupted ? ".concat(s)},w}function A(a,n){var s=new B("An XML file has invalid xml");throw s.properties={id:"file_has_invalid_xml",content:a,offset:n,explanation:"The docx contains invalid XML, it is most likely corrupt"},s}function N(a){var n=new X('The filetype "'.concat(a,'" is not handled by docxtemplater'));throw n.properties={id:"filetype_not_handled",explanation:'The file you are trying to generate is of type "'.concat(a,'", but only docx and pptx formats are handled'),fileType:a},n}return Ie={XTError:q,XTTemplateError:B,XTInternalError:X,XTScopeParserError:D,XTAPIVersionError:V,RenderingError:I,XTRenderingError:I,getClosingTagNotMatchOpeningTag:j,getLoopPositionProducesInvalidXMLError:G,getScopeCompilationError:ee,getScopeParserExecutionError:Q,getUnclosedTagException:h,getUnopenedTagException:y,getUnmatchedLoopException:x,getDuplicateCloseTagException:c,getDuplicateOpenTagException:b,getCorruptCharactersException:v,getInvalidRawXMLValueException:l,getUnbalancedLoopException:S,throwApiVersionError:Z,throwFileTypeNotHandled:N,throwFileTypeNotIdentified:fe,throwMalformedXml:ne,throwMultiError:m,throwExpandNotFound:i,throwRawTagShouldBeOnlyTextInParagraph:u,throwUnimplementedTagType:W,throwXmlTagNotFound:f,throwXmlInvalid:A,throwResolveBeforeCompile:ie,throwRenderInvalidTemplate:se,throwRenderTwice:ue},Ie}var Me,ur;function ve(){if(ur)return Me;ur=1;function E(r,t){return U(r)||_(r,t)||L(r,t)||H()}function H(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function L(r,t){if(r){if(typeof r=="string")return O(r,t);var e={}.toString.call(r).slice(8,-1);return e==="Object"&&r.constructor&&(e=r.constructor.name),e==="Map"||e==="Set"?Array.from(r):e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?O(r,t):void 0}}function O(r,t){(t==null||t>r.length)&&(t=r.length);for(var e=0,o=Array(t);e<t;e++)o[e]=r[e];return o}function _(r,t){var e=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(e!=null){var o,T,K,Y,te=[],oe=!0,le=!1;try{if(K=(e=e.call(r)).next,t!==0)for(;!(oe=(o=K.call(e)).done)&&(te.push(o.value),te.length!==t);oe=!0);}catch(ce){le=!0,T=ce}finally{try{if(!oe&&e.return!=null&&(Y=e.return(),Object(Y)!==Y))return}finally{if(le)throw T}}return te}}function U(r){if(Array.isArray(r))return r}var M=_r(),R=M.DOMParser,C=M.XMLSerializer,q=be(),B=q.throwXmlTagNotFound,I=or(),D=I.last,X=I.first;function V(r){return/^[ \n\r\t]+$/.test(r)}function Z(r){return{get:function(e){return r==="."?e:e&&e[r]}}}var m={};function y(r,t,e){var o;if(m[t]?o=m[t]:(o=new RegExp("(<.* ".concat(t,'=")([^"]*)(".*)$')),m[t]=o),o.test(r))return r.replace(o,"$1".concat(e,"$3"));var T=r.lastIndexOf("/>");return T===-1&&(T=r.lastIndexOf(">")),r.substr(0,T)+" ".concat(t,'="').concat(e,'"')+r.substr(T)}function b(r,t){var e=r.indexOf(" ".concat(t,'="'));if(e===-1)return null;var o=r.substr(e).search(/["']/)+e,T=r.substr(o+1).search(/["']/)+o;return r.substr(o+1,T-o)}function c(r,t){return r.indexOf(t,r.length-t.length)!==-1}function h(r,t){return r.substring(0,t.length)===t}function f(r){for(var t=[],e={},o=[],T=0,K=r.length;T<K;++T)e[r[T]]?t.push(r[T]):(e[r[T]]=!0,o.push(r[T]));return t}function v(r){for(var t={},e=[],o=0,T=r.length;o<T;++o)t[r[o]]||(t[r[o]]=!0,e.push(r[o]));return e}function l(r,t){for(var e=[[]],o=0;o<r.length;o++){var T=r[o],K=e[e.length-1],Y=t(T);Y==="start"?e.push([T]):Y==="end"?(K.push(T),e.push([])):K.push(T)}for(var te=[],oe=0;oe<e.length;oe++){var le=e[oe];le.length>0&&te.push(le)}return te}function i(){return{errorLogging:"json",stripInvalidXMLChars:!1,paragraphLoop:!1,nullGetter:function(t){return t.module?"":"undefined"},xmlFileNames:["[Content_Types].xml"],parser:Z,linebreaks:!1,fileTypeConfig:null,delimiters:{start:"{",end:"}"},syntax:{changeDelimiterPrefix:"="}}}function u(r){return new C().serializeToString(r).replace(/xmlns(:[a-z0-9]+)?="" ?/g,"")}function x(r){return r.charCodeAt(0)===65279&&(r=r.substr(1)),new R().parseFromString(r,"text/xml")}var S=[["&","&amp;"],["<","&lt;"],[">","&gt;"],['"',"&quot;"],["'","&apos;"]],j=S.map(function(r){var t=E(r,2),e=t[0],o=t[1];return{rstart:new RegExp(o,"g"),rend:new RegExp(e,"g"),start:o,end:e}});function ee(r){for(var t=j.length-1;t>=0;t--){var e=j[t];r=r.replace(e.rstart,e.end)}return r}function Q(r){r=r.toString();for(var t,e=0,o=j.length;e<o;e++)t=j[e],r=r.replace(t.rend,t.start);return r}function G(r){for(var t=[],e=0;e<r.length;e++)for(var o=r[e],T=0;T<o.length;T++){var K=o[T];t.push(K)}return t}function W(r,t){if(!t)return r;for(var e=0,o=t.length;e<o;e++)r.push(t[e]);return r}var ne=new RegExp(" ","g");function ie(r){return r.replace(ne," ")}function se(r,t){for(var e=[],o;(o=r.exec(t))!=null;)e.push({array:o,offset:o.index});return e}function ue(r,t){return r==="</"+t+">"}function fe(r,t){return r.indexOf("<"+t)===0&&[">"," ","/"].indexOf(r[t.length+1])!==-1}function A(r,t,e){var o=N(r,t,e);if(o!==null)return o;B({position:"right",element:t,parsed:r,index:e})}function N(r,t,e){typeof t=="string"&&(t=[t]);for(var o=1,T=e,K=r.length;T<K;T++)for(var Y=r[T],te=0,oe=t;te<oe.length;te++){var le=oe[te];if(ue(Y.value,le)&&o--,fe(Y.value,le)&&o++,o===0)return T}return null}function a(r,t,e){var o=n(r,t,e);if(o!==null)return o;B({position:"left",element:t,parsed:r,index:e})}function n(r,t,e){typeof t=="string"&&(t=[t]);for(var o=1,T=e;T>=0;T--)for(var K=r[T],Y=0,te=t;Y<te.length;Y++){var oe=te[Y];if(fe(K.value,oe)&&o--,ue(K.value,oe)&&o++,o===0)return T}return null}function s(r,t){var e=t.type,o=t.tag,T=t.position;return e==="tag"&&o===r&&(T==="start"||T==="selfclosing")}function w(r,t){var e=t.type,o=t.tag,T=t.position;return e==="tag"&&o===r&&T==="end"}function P(r){var t=r.type,e=r.tag,o=r.position;return["w:p","a:p"].indexOf(e)!==-1&&t==="tag"&&o==="start"}function z(r){var t=r.type,e=r.tag,o=r.position;return["w:p","a:p"].indexOf(e)!==-1&&t==="tag"&&o==="end"}function J(r){var t=r.type,e=r.position,o=r.text;return o&&t==="tag"&&e==="start"}function $(r){var t=r.type,e=r.position,o=r.text;return o&&t==="tag"&&e==="end"}function re(r){var t=r.type,e=r.position;return t==="placeholder"||t==="content"&&e==="insidetag"}function ae(r,t){var e=r.module,o=r.type;return t instanceof Array||(t=[t]),o==="placeholder"&&t.indexOf(e)!==-1}var p=/[\x00-\x08\x0B\x0C\x0E-\x1F]/g;function d(r){return p.lastIndex=0,p.test(r)}function g(r){return typeof r!="string"&&(r=String(r)),r.replace(p,"")}function F(r){var t={};for(var e in r){var o=r[e];t[o]||(t[o]=[]),t[o].push(e)}return t}function k(r,t){return r.map(function(e,o){return{item:e,index:o}}).sort(function(e,o){return t(e.item,o.item)||e.index-o.index}).map(function(e){var o=e.item;return o})}return Me={endsWith:c,startsWith:h,isContent:re,isParagraphStart:P,isParagraphEnd:z,isTagStart:s,isTagEnd:w,isTextStart:J,isTextEnd:$,isStarting:fe,isEnding:ue,isModule:ae,uniq:v,getDuplicates:f,chunkBy:l,last:D,first:X,xml2str:u,str2xml:x,getRightOrNull:N,getRight:A,getLeftOrNull:n,getLeft:a,pregMatchAll:se,convertSpaces:ie,charMapRegexes:j,hasCorruptCharacters:d,removeCorruptCharacters:g,getDefaults:i,wordToUtf8:ee,utf8ToWord:Q,concatArrays:G,pushArray:W,invertMap:F,charMap:S,getSingleAttribute:b,setSingleAttribute:y,isWhiteSpace:V,stableSort:k},Me}var Le,fr;function ar(){if(fr)return Le;fr=1;function E(A){"@babel/helpers - typeof";return E=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(N){return typeof N}:function(N){return N&&typeof Symbol=="function"&&N.constructor===Symbol&&N!==Symbol.prototype?"symbol":typeof N},E(A)}function H(A){return _(A)||O(A)||R(A)||L()}function L(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function O(A){if(typeof Symbol<"u"&&A[Symbol.iterator]!=null||A["@@iterator"]!=null)return Array.from(A)}function _(A){if(Array.isArray(A))return C(A)}function U(A,N){return B(A)||q(A,N)||R(A,N)||M()}function M(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function R(A,N){if(A){if(typeof A=="string")return C(A,N);var a={}.toString.call(A).slice(8,-1);return a==="Object"&&A.constructor&&(a=A.constructor.name),a==="Map"||a==="Set"?Array.from(A):a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?C(A,N):void 0}}function C(A,N){(N==null||N>A.length)&&(N=A.length);for(var a=0,n=Array(N);a<N;a++)n[a]=A[a];return n}function q(A,N){var a=A==null?null:typeof Symbol<"u"&&A[Symbol.iterator]||A["@@iterator"];if(a!=null){var n,s,w,P,z=[],J=!0,$=!1;try{if(w=(a=a.call(A)).next,N!==0)for(;!(J=(n=w.call(a)).done)&&(z.push(n.value),z.length!==N);J=!0);}catch(re){$=!0,s=re}finally{try{if(!J&&a.return!=null&&(P=a.return(),Object(P)!==P))return}finally{if($)throw s}}return z}}function B(A){if(Array.isArray(A))return A}function I(A,N){var a=Object.keys(A);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(A);N&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(A,s).enumerable})),a.push.apply(a,n)}return a}function D(A){for(var N=1;N<arguments.length;N++){var a=arguments[N]!=null?arguments[N]:{};N%2?I(Object(a),!0).forEach(function(n){X(A,n,a[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(A,Object.getOwnPropertyDescriptors(a)):I(Object(a)).forEach(function(n){Object.defineProperty(A,n,Object.getOwnPropertyDescriptor(a,n))})}return A}function X(A,N,a){return(N=V(N))in A?Object.defineProperty(A,N,{value:a,enumerable:!0,configurable:!0,writable:!0}):A[N]=a,A}function V(A){var N=Z(A,"string");return E(N)=="symbol"?N:N+""}function Z(A,N){if(E(A)!="object"||!A)return A;var a=A[Symbol.toPrimitive];if(a!==void 0){var n=a.call(A,N);if(E(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(N==="string"?String:Number)(A)}var m=ve(),y=m.getRightOrNull,b=m.getRight,c=m.getLeft,h=m.getLeftOrNull,f=m.chunkBy,v=m.isTagStart,l=m.isTagEnd,i=m.isContent,u=m.last,x=m.first,S=be(),j=S.XTTemplateError,ee=S.throwExpandNotFound,Q=S.getLoopPositionProducesInvalidXMLError;function G(A,N){if(A.length===0)return!1;var a=u(A).substr(1);return a.indexOf(N)===0}function W(A){for(var N=[],a=0;a<A.length;a++){var n=A[a],s=n.position,w=n.value,P=n.tag;P&&(s==="end"?G(N,P)?N.pop():N.push(w):s==="start"&&N.push(w))}return N}function ne(A,N){for(var a=0;a<N.length;a++){var n=N[a];if(n.indexOf("<".concat(A))===0)return!0}return!1}function ie(A,N,a){var n=A.slice(N[0].offset,N[1].offset),s=W(n),w=s.filter(function(re){return re[1]==="/"}).length,P=s.filter(function(re){return re[1]!=="/"&&re[re.length-2]!=="/"}).length;if(w!==P)return{error:Q({tag:x(N).part.value,offset:[x(N).part.offset,u(N).part.offset]})};for(var z=function(){var ae=a[$],p=ae.contains,d=ae.expand,g=ae.onlyTextInTag;if(ne(p,s)){if(g){var F=h(A,p,N[0].offset),k=y(A,p,N[1].offset);if(F===null||k===null)return 0;var r=f(A.slice(F,k),function(K){return v(p,K)?"start":l(p,K)?"end":null}),t=x(r),e=u(r),o=t.filter(i),T=e.filter(i);if(o.length!==1||T.length!==1)return 0}return{v:{value:d}}}},J,$=0;$<a.length;$++)if(J=z(),J!==0&&J)return J.v;return{}}function se(A,N,a,n){var s=A.expandTo||n.expandTo;if(s){var w,P;try{P=c(a,s,N),w=b(a,s,N)}catch($){var z=D({part:A,rootError:$,postparsed:a,expandTo:s,index:N},n.error);if(n.onError){var J=n.onError(z);if(J==="ignore")return}ee(z)}return[P,w]}}function ue(A,N,a,n){var s=U(A,2),w=s[0],P=s[1],z=a.indexOf(N),J=a.slice(w,z),$=a.slice(z+1,P+1),re=n.getInner({postparse:n.postparse,index:z,part:N,leftParts:J,rightParts:$,left:w,right:P,postparsed:a});return re.length||(re.expanded=[J,$],re=[re]),{left:w,right:P,inner:re}}function fe(A,N){var a=[];A.errors&&(a=A.errors,A=A.postparsed);for(var n=[],s=0,w=A.length;s<w;s++){var P=A[s];if(P.type==="placeholder"&&P.module===N.moduleName&&!P.subparsed&&!P.expanded)try{var z=se(P,s,A,N);if(!z)continue;var J=U(z,2),$=J[0],re=J[1];n.push({left:$,right:re,part:P,i:s,leftPart:A[$],rightPart:A[re]})}catch(e){a.push(e)}}n.sort(function(e,o){return e.left===o.left?o.part.lIndex<e.part.lIndex?1:-1:o.left<e.left?1:-1});for(var ae=-1,p=0,d=0,g=n.length;d<g;d++){var F,k=n[d];if(ae=Math.max(ae,d>0?n[d-1].right:0),!(k.left<ae)){var r=void 0;try{r=ue([k.left+p,k.right+p],k.part,A,N)}catch(e){if(N.onError){var t=N.onError(D({part:k.part,rootError:e,postparsed:A,expandOne:ue},N.errors));if(t==="ignore")continue}if(e instanceof j)a.push(e);else throw e}r&&(p+=r.inner.length-(r.right+1-r.left),(F=A).splice.apply(F,[r.left,r.right+1-r.left].concat(H(r.inner))))}}return{postparsed:A,errors:a}}return Le={expandToOne:fe,getExpandToDefault:ie},Le}var Re,cr;function Pe(){if(cr)return Re;cr=1;var E=be(),H=E.XTInternalError;function L(){}function O(_){return _}return Re=function(_){var U={set:L,matchers:function(){return[]},parse:L,render:L,getTraits:L,getFileType:L,nullGetter:L,optionsTransformer:O,postrender:O,errorsTransformer:O,getRenderedMap:O,preparse:O,postparse:O,on:L,resolve:L,preResolve:L};if(Object.keys(U).every(function(C){return!_[C]})){var M=new H("This module cannot be wrapped, because it doesn't define any of the necessary functions");throw M.properties={id:"module_cannot_be_wrapped",explanation:"This module cannot be wrapped, because it doesn't define any of the necessary functions"},M}for(var R in U)_[R]||(_[R]=U[R]);return _},Re}var ke,pr;function ir(){if(pr)return ke;pr=1;var E="application/vnd.openxmlformats-officedocument.wordprocessingml.document.main+xml",H="application/vnd.ms-word.document.macroEnabled.main+xml",L="application/vnd.openxmlformats-officedocument.wordprocessingml.template.main+xml",O="application/vnd.ms-word.template.macroEnabledTemplate.main+xml",_="application/vnd.openxmlformats-officedocument.wordprocessingml.header+xml",U="application/vnd.openxmlformats-officedocument.wordprocessingml.footnotes+xml",M="application/vnd.openxmlformats-officedocument.wordprocessingml.comments+xml",R="application/vnd.openxmlformats-officedocument.wordprocessingml.footer+xml",C="application/vnd.openxmlformats-officedocument.presentationml.slide+xml",q="application/vnd.openxmlformats-officedocument.presentationml.slideMaster+xml",B="application/vnd.openxmlformats-officedocument.presentationml.slideLayout+xml",I="application/vnd.openxmlformats-officedocument.presentationml.presentation.main+xml",D="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",X="application/vnd.ms-excel.sheet.macroEnabled.main+xml",V="application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",Z=[E,H,L,O],m={main:Z,docx:[_].concat(Z,[R,U,M]),pptx:[C,q,B,I],xlsx:[D,X,V]};return ke=m,ke}var De,hr;function Fr(){if(hr)return De;hr=1;var E="application/vnd.openxmlformats-package.core-properties+xml",H="application/vnd.openxmlformats-officedocument.extended-properties+xml",L="application/vnd.openxmlformats-officedocument.custom-properties+xml",O="application/vnd.openxmlformats-officedocument.wordprocessingml.settings+xml",_="application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml",U="application/vnd.ms-office.drawingml.diagramDrawing+xml";return De={settingsContentType:O,coreContentType:E,appContentType:H,customContentType:L,diagramDataContentType:_,diagramDrawingContentType:U},De}var qe,vr;function Wr(){if(vr)return qe;vr=1;function E(c){"@babel/helpers - typeof";return E=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(h){return typeof h}:function(h){return h&&typeof Symbol=="function"&&h.constructor===Symbol&&h!==Symbol.prototype?"symbol":typeof h},E(c)}function H(c,h){if(!(c instanceof h))throw new TypeError("Cannot call a class as a function")}function L(c,h){for(var f=0;f<h.length;f++){var v=h[f];v.enumerable=v.enumerable||!1,v.configurable=!0,"value"in v&&(v.writable=!0),Object.defineProperty(c,_(v.key),v)}}function O(c,h,f){return h&&L(c.prototype,h),Object.defineProperty(c,"prototype",{writable:!1}),c}function _(c){var h=U(c,"string");return E(h)=="symbol"?h:h+""}function U(c,h){if(E(c)!="object"||!c)return c;var f=c[Symbol.toPrimitive];if(f!==void 0){var v=f.call(c,h);if(E(v)!="object")return v;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(c)}var M=ve(),R=M.pushArray,C=Pe(),q=ir(),B=Fr(),I=B.settingsContentType,D=B.coreContentType,X=B.appContentType,V=B.customContentType,Z=B.diagramDataContentType,m=B.diagramDrawingContentType,y=[I,D,X,V,Z,m],b=function(){function c(){H(this,c),this.name="Common"}return O(c,[{key:"getFileType",value:function(f){var v=f.doc,l=v.invertedContentTypes;if(l){for(var i=0;i<y.length;i++){var u=y[i];l[u]&&R(v.targets,l[u])}for(var x=["docx","pptx","xlsx"],S,j=0;j<x.length;j++){for(var ee=x[j],Q=q[ee],G=0;G<Q.length;G++){var W=Q[G];if(l[W])for(var ne=0,ie=l[W];ne<ie.length;ne++){var se=ie[ne];v.relsTypes[se]&&["http://purl.oclc.org/ooxml/officeDocument/relationships/officeDocument","http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument"].indexOf(v.relsTypes[se])===-1||(S=ee,(q.main.indexOf(W)!==-1||W===q.pptx[0])&&(v.textTarget||(v.textTarget=se)),S!=="xlsx"&&v.targets.push(se))}}if(S)return S}return S}}}])}();return qe=function(){return C(new b)},qe}var Fe,dr;function Vr(){if(dr)return Fe;dr=1;function E(m){"@babel/helpers - typeof";return E=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(y){return typeof y}:function(y){return y&&typeof Symbol=="function"&&y.constructor===Symbol&&y!==Symbol.prototype?"symbol":typeof y},E(m)}function H(m,y){if(!(m instanceof y))throw new TypeError("Cannot call a class as a function")}function L(m,y){for(var b=0;b<y.length;b++){var c=y[b];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(m,_(c.key),c)}}function O(m,y,b){return y&&L(m.prototype,y),Object.defineProperty(m,"prototype",{writable:!1}),m}function _(m){var y=U(m,"string");return E(y)=="symbol"?y:y+""}function U(m,y){if(E(m)!="object"||!m)return m;var b=m[Symbol.toPrimitive];if(b!==void 0){var c=b.call(m,y);if(E(c)!="object")return c;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(m)}var M=be(),R=M.getScopeParserExecutionError,C=or(),q=C.last,B=ve(),I=B.concatArrays;function D(m,y){for(var b=m.length>>>0,c,h=0;h<b;h++)if(c=m[h],y.call(this,c,h,m))return c}function X(m,y,b){var c=this,h=this.scopeList[b];if(this.root.finishedResolving){for(var f=this.resolved,v=function(){var j=c.scopeLindex[l];f=D(f,function(ee){return ee.lIndex===j}),f=f.value[c.scopePathItem[l]]},l=this.resolveOffset,i=this.scopePath.length;l<i;l++)v();return D(f,function(S){return y.part.lIndex===S.lIndex}).value}var u,x;!this.cachedParsers||!y.part?x=this.parser(m,{tag:y.part,scopePath:this.scopePath}):this.cachedParsers[y.part.lIndex]?x=this.cachedParsers[y.part.lIndex]:x=this.cachedParsers[y.part.lIndex]=this.parser(m,{tag:y.part,scopePath:this.scopePath});try{u=x.get(h,this.getContext(y,b))}catch(S){throw R({tag:m,scope:h,error:S,offset:y.part.offset})}return u==null&&b>0?X.call(this,m,y,b-1):u}function V(m,y,b){var c=this,h=this.scopeList[b],f;return!this.cachedParsers||!y.part?f=this.parser(m,{tag:y.part,scopePath:this.scopePath}):this.cachedParsers[y.part.lIndex]?f=this.cachedParsers[y.part.lIndex]:f=this.cachedParsers[y.part.lIndex]=this.parser(m,{tag:y.part,scopePath:this.scopePath}),Promise.resolve().then(function(){return f.get(h,c.getContext(y,b))}).catch(function(v){throw R({tag:m,scope:h,error:v,offset:y.part.offset})}).then(function(v){return v==null&&b>0?V.call(c,m,y,b-1):v})}var Z=function(){function m(y){H(this,m),this.root=y.root||this,this.resolveOffset=y.resolveOffset||0,this.scopePath=y.scopePath,this.scopePathItem=y.scopePathItem,this.scopePathLength=y.scopePathLength,this.scopeList=y.scopeList,this.scopeType="",this.scopeTypes=y.scopeTypes,this.scopeLindex=y.scopeLindex,this.parser=y.parser,this.resolved=y.resolved,this.cachedParsers=y.cachedParsers}return O(m,[{key:"loopOver",value:function(b,c,h,f){return this.loopOverValue(this.getValue(b,f),c,h)}},{key:"functorIfInverted",value:function(b,c,h,f,v){return b&&c(h,f,v),b}},{key:"isValueFalsy",value:function(b,c){return b==null||!b||c==="[object Array]"&&b.length===0}},{key:"loopOverValue",value:function(b,c,h){this.root.finishedResolving&&(h=!1);var f=Object.prototype.toString.call(b);if(this.isValueFalsy(b,f))return this.scopeType=!1,this.functorIfInverted(h,c,q(this.scopeList),0,1);if(f==="[object Array]"){this.scopeType="array";for(var v=0;v<b.length;v++)this.functorIfInverted(!h,c,b[v],v,b.length);return!0}return f==="[object Object]"?(this.scopeType="object",this.functorIfInverted(!h,c,b,0,1)):this.functorIfInverted(!h,c,q(this.scopeList),0,1)}},{key:"getValue",value:function(b,c){var h=X.call(this,b,c,this.scopeList.length-1);return typeof h=="function"?h(this.scopeList[this.scopeList.length-1],this):h}},{key:"getValueAsync",value:function(b,c){var h=this;return V.call(this,b,c,this.scopeList.length-1).then(function(f){return typeof f=="function"?f(h.scopeList[h.scopeList.length-1],h):f})}},{key:"getContext",value:function(b,c){return{num:c,meta:b,scopeList:this.scopeList,resolved:this.resolved,scopePath:this.scopePath,scopeTypes:this.scopeTypes,scopePathItem:this.scopePathItem,scopePathLength:this.scopePathLength}}},{key:"createSubScopeManager",value:function(b,c,h,f,v){return new m({root:this.root,resolveOffset:this.resolveOffset,resolved:this.resolved,parser:this.parser,cachedParsers:this.cachedParsers,scopeTypes:I([this.scopeTypes,[this.scopeType]]),scopeList:I([this.scopeList,[b]]),scopePath:I([this.scopePath,[c]]),scopePathItem:I([this.scopePathItem,[h]]),scopePathLength:I([this.scopePathLength,[v]]),scopeLindex:I([this.scopeLindex,[f.lIndex]])})}}])}();return Fe=function(m){return m.scopePath=[],m.scopePathItem=[],m.scopePathLength=[],m.scopeTypes=[],m.scopeLindex=[],m.scopeList=[m.tags],new Z(m)},Fe}var Xe,gr;function Xr(){if(gr)return Xe;gr=1;function E(n){"@babel/helpers - typeof";return E=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(s){return typeof s}:function(s){return s&&typeof Symbol=="function"&&s.constructor===Symbol&&s!==Symbol.prototype?"symbol":typeof s},E(n)}function H(n,s){return M(n)||U(n,s)||O(n,s)||L()}function L(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function O(n,s){if(n){if(typeof n=="string")return _(n,s);var w={}.toString.call(n).slice(8,-1);return w==="Object"&&n.constructor&&(w=n.constructor.name),w==="Map"||w==="Set"?Array.from(n):w==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(w)?_(n,s):void 0}}function _(n,s){(s==null||s>n.length)&&(s=n.length);for(var w=0,P=Array(s);w<s;w++)P[w]=n[w];return P}function U(n,s){var w=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(w!=null){var P,z,J,$,re=[],ae=!0,p=!1;try{if(J=(w=w.call(n)).next,s!==0)for(;!(ae=(P=J.call(w)).done)&&(re.push(P.value),re.length!==s);ae=!0);}catch(d){p=!0,z=d}finally{try{if(!ae&&w.return!=null&&($=w.return(),Object($)!==$))return}finally{if(p)throw z}}return re}}function M(n){if(Array.isArray(n))return n}function R(n,s){var w=Object.keys(n);if(Object.getOwnPropertySymbols){var P=Object.getOwnPropertySymbols(n);s&&(P=P.filter(function(z){return Object.getOwnPropertyDescriptor(n,z).enumerable})),w.push.apply(w,P)}return w}function C(n){for(var s=1;s<arguments.length;s++){var w=arguments[s]!=null?arguments[s]:{};s%2?R(Object(w),!0).forEach(function(P){q(n,P,w[P])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(w)):R(Object(w)).forEach(function(P){Object.defineProperty(n,P,Object.getOwnPropertyDescriptor(w,P))})}return n}function q(n,s,w){return(s=B(s))in n?Object.defineProperty(n,s,{value:w,enumerable:!0,configurable:!0,writable:!0}):n[s]=w,n}function B(n){var s=I(n,"string");return E(s)=="symbol"?s:s+""}function I(n,s){if(E(n)!="object"||!n)return n;var w=n[Symbol.toPrimitive];if(w!==void 0){var P=w.call(n,s);if(E(P)!="object")return P;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(n)}var D=be(),X=D.getUnclosedTagException,V=D.getUnopenedTagException,Z=D.getDuplicateOpenTagException,m=D.getDuplicateCloseTagException,y=D.throwMalformedXml,b=D.throwXmlInvalid,c=D.XTTemplateError,h=ve(),f=h.isTextStart,v=h.isTextEnd,l=h.wordToUtf8,i=h.pushArray,u=0,x=1,S=2,j=3;function ee(n,s){return n[0]<=s.offset&&s.offset<n[1]}function Q(n,s){return f(n)?(s&&y(),!0):v(n)?(s||y(),!1):s}function G(n){var s="",w=1,P=n.indexOf(" ");return n[n.length-2]==="/"?(s="selfclosing",P===-1&&(P=n.length-2)):n[1]==="/"?(w=2,s="end",P===-1&&(P=n.length-1)):(s="start",P===-1&&(P=n.length-1)),{tag:n.slice(w,P),position:s}}function W(n,s,w){for(var P=0,z=n.length,J={},$=0;$<s.length;$++){var re=s[$];J[re]=!0}for(var ae=0;ae<w.length;ae++){var p=w[ae];J[p]=!1}for(var d=[];P<z&&(P=n.indexOf("<",P),P!==-1);){var g=P,F=n.indexOf("<",P+1);P=n.indexOf(">",P),(P===-1||F!==-1&&P>F)&&b(n,g);var k=n.slice(g,P+1),r=G(k),t=r.tag,e=r.position,o=J[t];o!=null&&d.push({type:"tag",position:e,text:o,offset:g,value:k,tag:t})}return d}function ne(n,s,w){var P=[],z=!1,J={offset:0},$,re=n.reduce(function(p,d){var g=d.position,F=d.offset,k=J.offset,r=J.length;if($=s.substr(k,F-k),z&&g==="start"){if(k+r===F&&($=s.substr(k,F-k+r+4),!w.allowUnclosedTag))return P.push(Z({xtag:$,offset:k})),J=d,p.push(C(C({},d),{},{error:!0})),p;if(!w.allowUnclosedTag)return P.push(X({xtag:l($),offset:k})),J=d,p.push(C(C({},d),{},{error:!0})),p;p.pop()}return!z&&g==="end"?w.allowUnopenedTag?p:k+r===F?($=s.substr(k-4,F-k+r+4),P.push(m({xtag:$,offset:k})),J=d,p.push(C(C({},d),{},{error:!0})),p):(P.push(V({xtag:$,offset:F})),J=d,p.push(C(C({},d),{},{error:!0})),p):(z=g==="start",J=d,p.push(d),p)},[]);if(z){var ae=J.offset;$=s.substr(ae,s.length-ae),w.allowUnclosedTag?re.pop():P.push(X({xtag:l($),offset:ae}))}return{delimiterWithErrors:re,errors:P}}function ie(n,s){return n===-1&&s===-1?u:n===s?x:n===-1||s===-1?s<n?S:j:n<s?S:j}function se(n){var s=n.split(" ");if(s.length!==2){var w=new c("New Delimiters cannot be parsed");throw w.properties={id:"change_delimiters_invalid",explanation:"Cannot parser delimiters"},w}var P=H(s,2),z=P[0],J=P[1];if(z.length===0||J.length===0){var $=new c("New Delimiters cannot be parsed");throw $.properties={id:"change_delimiters_invalid",explanation:"Cannot parser delimiters"},$}return[z,J]}function ue(n,s,w){var P=[],z=s.start,J=s.end,$=-1,re=!1;if(z==null&&J==null)return[];for(;;){var ae=n.indexOf(z,$+1),p=n.indexOf(J,$+1),d=null,g=void 0,F=ie(ae,p);switch(F===x&&(F=re?j:S),F){case u:return P;case j:re=!1,$=p,d="end",g=J.length;break;case S:re=!0,$=ae,d="start",g=z.length;break}if(w.changeDelimiterPrefix&&F===S&&n[$+z.length]===w.changeDelimiterPrefix){P.push({offset:ae,position:"start",length:z.length,changedelimiter:!0});var k=n.indexOf(w.changeDelimiterPrefix,$+z.length+1),r=n.indexOf(J,k+1);P.push({offset:r,position:"end",length:J.length,changedelimiter:!0});var t=n.substr($+z.length+1,k-$-z.length-1),e=se(t),o=H(e,2);z=o[0],J=o[1],$=r;continue}P.push({offset:$,position:d,length:g})}}function fe(n,s,w){var P=n.map(function(k){return k.value}).join(""),z=ue(P,s,w),J=0,$=n.map(function(k){return J+=k.value.length,{offset:J-k.value.length,lIndex:k.lIndex}}),re=ne(z,P,w),ae=re.delimiterWithErrors,p=re.errors,d=0,g=0,F=$.map(function(k,r){for(var t=k.offset,e=[t,t+n[r].value.length],o=n[r].value,T=[];g<ae.length&&ee(e,ae[g]);)T.push(ae[g]),g++;var K=[],Y=0;d>0&&(Y=d,d=0);for(var te=0;te<T.length;te++){var oe=T[te],le=o.substr(Y,oe.offset-t-Y);if(oe.changedelimiter){oe.position==="start"?le.length>0&&K.push({type:"content",value:le}):Y=oe.offset-t+oe.length;continue}le.length>0&&(K.push({type:"content",value:le}),Y+=le.length);var ce={type:"delimiter",position:oe.position,offset:Y+t};K.push(ce),Y=oe.offset-t+oe.length}d=Y-o.length;var pe=o.substr(Y);return pe.length>0&&K.push({type:"content",value:pe}),K},this);return{parsed:F,errors:p}}function A(n){return n.type==="content"&&n.position==="insidetag"}function N(n){return n.filter(A)}function a(n,s){for(var w=!1,P=0;P<n.length;P++){var z=n[P];w=Q(z,w),z.type==="content"&&(z.position=w?"insidetag":"outsidetag"),s!=="text"&&A(z)&&(z.value=z.value.replace(/>/g,"&gt;"))}}return Xe={parseDelimiters:fe,parse:function(s,w,P,z){a(s,z);for(var J=fe(N(s),w,P),$=J.parsed,re=J.errors,ae=[],p=0,d=0,g=0;g<s.length;g++){var F=s[g];if(A(F)){for(var k=0,r=$[p];k<r.length;k++){var t=r[k];t.type==="content"&&(t.position="insidetag"),t.lIndex=d++}i(ae,$[p]),p++}else F.lIndex=d++,ae.push(F)}return{errors:re,lexed:ae}},xmlparse:function(s,w){var P=W(s,w.text,w.other),z=0,J=P.reduce(function($,re){return s.length>z&&re.offset-z>0&&$.push({type:"content",value:s.substr(z,re.offset-z)}),z=re.offset+re.value.length,delete re.offset,$.push(re),$},[]);return s.length>z&&J.push({type:"content",value:s.substr(z)}),J}},Xe}var Ne,yr;function zr(){if(yr)return Ne;yr=1;function E(C){return _(C)||O(C)||L(C)||H()}function H(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function L(C,q){if(C){if(typeof C=="string")return U(C,q);var B={}.toString.call(C).slice(8,-1);return B==="Object"&&C.constructor&&(B=C.constructor.name),B==="Map"||B==="Set"?Array.from(C):B==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(B)?U(C,q):void 0}}function O(C){if(typeof Symbol<"u"&&C[Symbol.iterator]!=null||C["@@iterator"]!=null)return Array.from(C)}function _(C){if(Array.isArray(C))return U(C)}function U(C,q){(q==null||q>C.length)&&(q=C.length);for(var B=0,I=Array(q);B<q;B++)I[B]=C[B];return I}function M(C){return C.type==="placeholder"}function R(C){var q={},B=[{items:C.filter(M),parents:[],path:[]}];function I(W,ne,ie){ie.length&&B.push({items:ie,parents:[].concat(E(ne.parents),[W]),path:W.dataBound!==!1&&!W.attrParsed&&W.value&&!W.attrParsed?[].concat(E(ne.path),[W.value]):E(ne.path)})}function D(W,ne){for(var ie=arguments.length>2&&arguments[2]!==void 0?arguments[2]:ne.length,se=W,ue=0;ue<ie;ue++)se=se[ne[ue]];return se}function X(W,ne){return ne.reduce(function(ie,se){var ue=typeof se.lIndex=="number"?se.lIndex:parseInt(se.lIndex.split("-")[0],10);return ue>W.lIndex?ie-1:ie},ne.length)}for(;B.length>0;)for(var V=B.pop(),Z=D(q,V.path),m=0,y=V.items;m<y.length;m++){var b,c,h=y[m];if(h.attrParsed){for(var f in h.attrParsed)I(h,V,h.attrParsed[f].filter(M));continue}if(h.subparsed){if(h.dataBound!==!1){var v,l;(v=Z)[l=h.value]||(v[l]={})}I(h,V,h.subparsed.filter(M));continue}if(h.cellParsed){for(var i=0,u=h.cellPostParsed;i<u.length;i++){var x=u[i];if(x.type==="placeholder"){if(x.module==="pro-xml-templating/xls-module-loop")continue;if(x.subparsed){var S,j;(S=Z)[j=x.value]||(S[j]={}),I(x,V,x.subparsed.filter(M))}else{var ee,Q,G=X(h,V.parents);Z=D(q,V.path,G),(ee=Z)[Q=x.value]||(ee[Q]={})}}}continue}h.dataBound!==!1&&((b=Z)[c=h.value]||(b[c]={}))}return q}return Ne={getTags:R,isPlaceholder:M},Ne}var Ue,mr;function Gr(){if(mr)return Ue;mr=1;var E=ve(),H=E.pushArray;function L(_,U){return U instanceof Error?H(Object.getOwnPropertyNames(U),["stack"]).reduce(function(M,R){return M[R]=U[R],R==="stack"&&(M[R]=U[R].toString()),M},{}):U}function O(_,U){if(console.log(JSON.stringify({error:_},L,U==="json"?2:null)),_.properties&&_.properties.errors instanceof Array){var M=_.properties.errors.map(function(R){return R.properties.explanation}).join(`
`);console.log("errorMessages",M)}}return Ue=O,Ue}var _e,br;function Kr(){if(br)return _e;br=1;var E="[Content_Types].xml";function H(L,O,_){for(var U={},M=0;M<L.length;M++){var R=L[M],C=R.getAttribute("ContentType"),q=R.getAttribute("PartName").substr(1);U[q]=C}for(var B=function(){var X=O[I],V=X.getAttribute("ContentType"),Z=X.getAttribute("Extension");_.file(/./).map(function(m){var y=m.name;y.slice(y.length-Z.length)===Z&&!U[y]&&y!==E&&(U[y]=V)})},I=0;I<O.length;I++)B();return U}return _e=H,_e}var Be,xr;function Nr(){if(xr)return Be;xr=1;var E=ve(),H=E.pregMatchAll;return Be=function(O,_){var U={content:O},M=_.join("|"),R=new RegExp("(?:(<(?:".concat(M,")[^>]*>)([^<>]*)</(?:").concat(M,")>)|(<(?:").concat(M,")[^>]*/>)"),"g");return U.matches=H(R,U.content),U},Be}var We,wr;function Zr(){if(wr)return We;wr=1;function E(M){"@babel/helpers - typeof";return E=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(R){return typeof R}:function(R){return R&&typeof Symbol=="function"&&R.constructor===Symbol&&R!==Symbol.prototype?"symbol":typeof R},E(M)}var H=new RegExp(" ","g");function L(M){return M.replace(H," ")}function O(M,R){var C=E(M);if(C==="string")return L(R.substr(0,M.length))===M;if(M instanceof RegExp)return M.test(L(R));if(C==="function")return!!M(R)}function _(M,R){var C=E(M);if(C==="string")return L(R).substr(M.length);if(M instanceof RegExp)return L(R).match(M)[1];if(C==="function")return M(R)}function U(M,R){var C=E(M);if(C==="string")return[R,L(R).substr(M.length)];if(M instanceof RegExp)return L(R).match(M);if(C==="function")return[R,M(R)]}return We={match:O,getValue:_,getValues:U},We}var Ve,Tr;function Hr(){if(Tr)return Ve;Tr=1;function E(l){"@babel/helpers - typeof";return E=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},E(l)}function H(l,i){var u=Object.keys(l);if(Object.getOwnPropertySymbols){var x=Object.getOwnPropertySymbols(l);i&&(x=x.filter(function(S){return Object.getOwnPropertyDescriptor(l,S).enumerable})),u.push.apply(u,x)}return u}function L(l){for(var i=1;i<arguments.length;i++){var u=arguments[i]!=null?arguments[i]:{};i%2?H(Object(u),!0).forEach(function(x){O(l,x,u[x])}):Object.getOwnPropertyDescriptors?Object.defineProperties(l,Object.getOwnPropertyDescriptors(u)):H(Object(u)).forEach(function(x){Object.defineProperty(l,x,Object.getOwnPropertyDescriptor(u,x))})}return l}function O(l,i,u){return(i=_(i))in l?Object.defineProperty(l,i,{value:u,enumerable:!0,configurable:!0,writable:!0}):l[i]=u,l}function _(l){var i=U(l,"string");return E(i)=="symbol"?i:i+""}function U(l,i){if(E(l)!="object"||!l)return l;var u=l[Symbol.toPrimitive];if(u!==void 0){var x=u.call(l,i);if(E(x)!="object")return x;throw new TypeError("@@toPrimitive must return a primitive value.")}return(i==="string"?String:Number)(l)}function M(l,i){return I(l)||B(l,i)||C(l,i)||R()}function R(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function C(l,i){if(l){if(typeof l=="string")return q(l,i);var u={}.toString.call(l).slice(8,-1);return u==="Object"&&l.constructor&&(u=l.constructor.name),u==="Map"||u==="Set"?Array.from(l):u==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(u)?q(l,i):void 0}}function q(l,i){(i==null||i>l.length)&&(i=l.length);for(var u=0,x=Array(i);u<i;u++)x[u]=l[u];return x}function B(l,i){var u=l==null?null:typeof Symbol<"u"&&l[Symbol.iterator]||l["@@iterator"];if(u!=null){var x,S,j,ee,Q=[],G=!0,W=!1;try{if(j=(u=u.call(l)).next,i!==0)for(;!(G=(x=j.call(u)).done)&&(Q.push(x.value),Q.length!==i);G=!0);}catch(ne){W=!0,S=ne}finally{try{if(!G&&u.return!=null&&(ee=u.return(),Object(ee)!==ee))return}finally{if(W)throw S}}return Q}}function I(l){if(Array.isArray(l))return l}var D=ve(),X=D.wordToUtf8,V=D.pushArray,Z=Zr(),m=Z.match,y=Z.getValue,b=Z.getValues;function c(l,i){for(var u=[],x=0;x<l.length;x++){var S=l[x];if(S.matchers){var j=S.matchers(i);if(!(j instanceof Array))throw new Error("module matcher returns a non array");V(u,j)}}return u}function h(l,i,u){for(var x=[],S=0;S<l.length;S++){var j=l[S],ee=M(j,2),Q=ee[0],G=ee[1],W=j[2]||{};if(u.match(Q,i)){var ne=u.getValues(Q,i);if(typeof W=="function"&&(W=W(ne)),!W.value){var ie=M(ne,2);W.value=ie[1]}x.push(L({type:"placeholder",prefix:Q,module:G,onMatch:W.onMatch,priority:W.priority},W))}}return x}function f(l,i){var u=i.modules,x=i.startOffset,S=i.lIndex,j;i.offset=x,i.match=m,i.getValue=y,i.getValues=b;var ee=c(u,i),Q=h(ee,l,i);if(Q.length>0){for(var G=null,W=0;W<Q.length;W++){var ne=Q[W];ne.priority||(ne.priority=-ne.value.length),(!G||ne.priority>G.priority)&&(G=ne)}return G.offset=x,delete G.priority,G.endLindex=S,G.lIndex=S,G.raw=l,G.onMatch&&G.onMatch(G),delete G.onMatch,delete G.prefix,G}for(var ie=0;ie<u.length;ie++){var se=u[ie];if(j=se.parse(l,i),j)return j.offset=x,j.endLindex=S,j.lIndex=S,j.raw=l,j}return{type:"placeholder",value:l,offset:x,endLindex:S,lIndex:S}}var v={preparse:function(i,u,x){function S(j,ee){for(var Q=0;Q<u.length;Q++){var G=u[Q];j=G.preparse(j,ee)||j}return j}return S(i,x)},parse:function(i,u,x){var S=!1,j="",ee,Q=[],G=x.fileTypeConfig.droppedTagsInsidePlaceholder||[];return i.reduce(function(W,ne){return ne.type==="delimiter"?(S=ne.position==="start",ne.position==="end"&&(x.parse=function(ie){return f(ie,L(L(L({},x),ne),{},{startOffset:ee,modules:u}))},W.push(x.parse(X(j))),V(W,Q),Q=[]),ne.position==="start"&&(Q=[],ee=ne.offset),j="",W):S?ne.type!=="content"||ne.position!=="insidetag"?(G.indexOf(ne.tag)!==-1||Q.push(ne),W):(j+=ne.value,W):(W.push(ne),W)},[])},postparse:function(i,u,x){function S(Q,G){return u.map(function(W){return W.getTraits(Q,G)})}var j=[];function ee(Q,G){return u.reduce(function(W,ne){var ie=ne.postparse(W,L(L({},G),{},{postparse:function(ue,fe){return ee(ue,L(L({},G),fe))},getTraits:S}));return ie==null?W:ie.errors?(V(j,ie.errors),ie.postparsed):ie},Q)}return{postparsed:ee(i,x),errors:j}}};return Ve=v,Ve}var ze,Pr;function Ur(){if(Pr)return ze;Pr=1;function E(H,L){if(H.lIndex==null)return null;var O=L.scopeManager.scopePathItem;H.parentPart&&(O=O.slice(0,O.length-1));var _=L.filePath+"@"+H.lIndex.toString()+"-"+O.join("-");return _}return ze=E,ze}var Ge,Sr;function Yr(){if(Sr)return Ge;Sr=1;var E=be(),H=E.throwUnimplementedTagType,L=E.XTScopeParserError,O=ve(),_=O.pushArray,U=Ur();function M(C,q){for(var B=0,I=q.modules;B<I.length;B++){var D=I[B],X=D.render(C,q);if(X)return X}return!1}function R(C){var q=C.baseNullGetter,B=C.compiled,I=C.scopeManager;C.nullGetter=function(V,Z){return q(V,Z||I)};var D=[],X=B.map(function(V,Z){C.index=Z,C.resolvedId=U(V,C);var m;try{m=M(V,C)}catch(y){if(y instanceof L)return D.push(y),V;throw y}if(m)return m.errors&&_(D,m.errors),m;if(V.type==="content"||V.type==="tag")return V;H(V,Z)}).reduce(function(V,Z){var m=Z.value;return m instanceof Array?_(V,m):m&&V.push(m),V},[]);return{errors:D,parts:X}}return Ge=R,Ge}var Ke,Er;function Jr(){if(Er)return Ke;Er=1;function E(L){var O,_,U,M,R=0,C=L.length;for(U=0;U<C;U++)O=L.charCodeAt(U),(O&64512)===55296&&U+1<C&&(_=L.charCodeAt(U+1),(_&64512)===56320&&(O=65536+(O-55296<<10)+(_-56320),U++)),R+=O<128?1:O<2048?2:O<65536?3:4;var q=new Uint8Array(R);for(M=0,U=0;M<R;U++)O=L.charCodeAt(U),(O&64512)===55296&&U+1<C&&(_=L.charCodeAt(U+1),(_&64512)===56320&&(O=65536+(O-55296<<10)+(_-56320),U++)),O<128?q[M++]=O:O<2048?(q[M++]=192|O>>>6,q[M++]=128|O&63):O<65536?(q[M++]=224|O>>>12,q[M++]=128|O>>>6&63,q[M++]=128|O&63):(q[M++]=240|O>>>18,q[M++]=128|O>>>12&63,q[M++]=128|O>>>6&63,q[M++]=128|O&63);return q}function H(L,O){for(var _=0,U=O.modules;_<U.length;_++){var M=U[_];L=M.postrender(L,O)}for(var R=0,C=O.joinUncorrupt(L,O),q="",B=0,I=65536,D=[],X=0,V=C.length;X<V;X++){var Z=C[X];if(Z.length+B>I){var m=E(q);R+=m.length,D.push(m),q=""}q+=Z,B+=Z.length,delete C[X]}var y=E(q);R+=y.length,D.push(y);for(var b=new Uint8Array(R),c=0,h=0;h<D.length;h++){for(var f=D[h],v=0;v<f.length;++v)b[v+c]=f[v];c+=f.length}return b}return Ke=H,Ke}var Ze,Cr;function Qr(){if(Cr)return Ze;Cr=1;function E(I){"@babel/helpers - typeof";return E=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(D){return typeof D}:function(D){return D&&typeof Symbol=="function"&&D.constructor===Symbol&&D!==Symbol.prototype?"symbol":typeof D},E(I)}function H(I,D){var X=Object.keys(I);if(Object.getOwnPropertySymbols){var V=Object.getOwnPropertySymbols(I);D&&(V=V.filter(function(Z){return Object.getOwnPropertyDescriptor(I,Z).enumerable})),X.push.apply(X,V)}return X}function L(I){for(var D=1;D<arguments.length;D++){var X=arguments[D]!=null?arguments[D]:{};D%2?H(Object(X),!0).forEach(function(V){O(I,V,X[V])}):Object.getOwnPropertyDescriptors?Object.defineProperties(I,Object.getOwnPropertyDescriptors(X)):H(Object(X)).forEach(function(V){Object.defineProperty(I,V,Object.getOwnPropertyDescriptor(X,V))})}return I}function O(I,D,X){return(D=_(D))in I?Object.defineProperty(I,D,{value:X,enumerable:!0,configurable:!0,writable:!0}):I[D]=X,I}function _(I){var D=U(I,"string");return E(D)=="symbol"?D:D+""}function U(I,D){if(E(I)!="object"||!I)return I;var X=I[Symbol.toPrimitive];if(X!==void 0){var V=X.call(I,D);if(E(V)!="object")return V;throw new TypeError("@@toPrimitive must return a primitive value.")}return(D==="string"?String:Number)(I)}var M=ve(),R=M.pushArray,C=Ur();function q(I,D){for(var X=0,V=D.modules;X<V.length;X++){var Z=V[X],m=Z.resolve(I,D);if(m)return m}return!1}function B(I){var D=[],X=I.baseNullGetter,V=I.compiled,Z=I.scopeManager;I.nullGetter=function(y,b){return X(y,b||Z)},I.resolved=D;var m=[];return Promise.all(V.filter(function(y){return["content","tag"].indexOf(y.type)===-1}).reduce(function(y,b){var c=q(b,L(L({},I),{},{resolvedId:C(b,I)})),h;if(c)h=c.then(function(f){D.push({tag:b.value,lIndex:b.lIndex,value:f})});else if(b.type==="placeholder")h=Z.getValueAsync(b.value,{part:b}).then(function(f){return f??I.nullGetter(b)}).then(function(f){return D.push({tag:b.value,lIndex:b.lIndex,value:f}),f});else return;return y.push(h.catch(function(f){f instanceof Array?R(m,f):m.push(f)})),y},[])).then(function(){return{errors:m,resolved:D}})}return Ze=B,Ze}var He,Or;function $r(){if(Or)return He;Or=1;var E=ve(),H=E.startsWith,L=E.endsWith,O=E.isStarting,_=E.isEnding,U=E.isWhiteSpace,M=ir();function R(q){for(var B="",I=0,D=q.length;I<D;I++){var X=q[I];U(X)||H(X,"<w:bookmarkEnd")||(L(B,"</w:tbl>")&&!H(X,"<w:p")&&!H(X,"<w:tbl")&&!H(X,"<w:sectPr")&&(X="<w:p/>".concat(X)),B=X,q[I]=X)}return q}function C(q,B){var I=B.fileTypeConfig.tagShouldContain||[],D="",X=-1;M.docx.indexOf(B.contentType)!==-1&&(q=R(q));for(var V=-1,Z=0,m=I.length;Z<m;Z++)for(var y=I[Z],b=y.tag,c=y.shouldContain,h=y.value,f=y.drop,v=y.dropParent,l=0,i=q.length;l<i;l++){var u=q[l];if(X===Z){if(_(u,b))if(X=-1,v){for(var x=-1,S=V;S>0;S--)if(O(q[S],v)){x=S;break}for(var j=x;j<=q.length;j++){if(_(q[j],v)){q[j]="";break}q[j]=""}}else{for(var ee=V;ee<=l;ee++)q[ee]="";f||(q[l]=D+h+u)}D+=u;for(var Q=0,G=c.length;Q<G;Q++){var W=c[Q];if(O(u,W)){X=-1;break}}}X===-1&&O(u,b)&&u.substr(1).indexOf("<")===-1&&(u[u.length-2]==="/"?q[l]="":(V=l,X=Z,D=u))}return q}return He=C,He}var Ye,jr;function et(){if(jr)return Ye;jr=1;function E(b){"@babel/helpers - typeof";return E=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(c){return typeof c}:function(c){return c&&typeof Symbol=="function"&&c.constructor===Symbol&&c!==Symbol.prototype?"symbol":typeof c},E(b)}function H(b,c){if(!(b instanceof c))throw new TypeError("Cannot call a class as a function")}function L(b,c){for(var h=0;h<c.length;h++){var f=c[h];f.enumerable=f.enumerable||!1,f.configurable=!0,"value"in f&&(f.writable=!0),Object.defineProperty(b,_(f.key),f)}}function O(b,c,h){return c&&L(b.prototype,c),Object.defineProperty(b,"prototype",{writable:!1}),b}function _(b){var c=U(b,"string");return E(c)=="symbol"?c:c+""}function U(b,c){if(E(b)!="object"||!b)return b;var h=b[Symbol.toPrimitive];if(h!==void 0){var f=h.call(b,c);if(E(f)!="object")return f;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(b)}var M=ve(),R=M.pushArray,C=M.wordToUtf8,q=M.convertSpaces,B=Nr(),I=Xr(),D=Hr(),X=Yr(),V=Jr(),Z=Qr(),m=$r();function y(b,c){var h=B(b,c),f=h.matches.map(function(v){return v.array[2]});return C(q(f.join("")))}return Ye=function(){function b(c,h){H(this,b),this.cachedParsers={},this.content=c;for(var f in h)this[f]=h[f];this.setModules({inspect:{filePath:h.filePath}})}return O(b,[{key:"resolveTags",value:function(h){var f=this;this.tags=h;var v=this.getOptions(),l=this.filePath;v.scopeManager=this.scopeManager,v.resolve=Z;var i=[];return Promise.all(this.modules.map(function(u){return Promise.resolve(u.preResolve(v)).catch(function(x){i.push(x)})})).then(function(){if(i.length!==0)throw i;return Z(v).then(function(u){var x=u.resolved,S=u.errors;if(S=S.map(function(j){var ee;return j instanceof Error||(j=new Error(j)),(ee=j).properties||(ee.properties={}),j.properties.file=l,j}),S.length!==0)throw S;return Promise.all(x).then(function(j){return v.scopeManager.root.finishedResolving=!0,v.scopeManager.resolved=j,f.setModules({inspect:{resolved:j,filePath:l}}),j})}).catch(function(u){throw f.errorChecker(u),u})})}},{key:"getFullText",value:function(){return y(this.content,this.fileTypeConfig.tagsXmlTextArray)}},{key:"setModules",value:function(h){for(var f=0,v=this.modules;f<v.length;f++){var l=v[f];l.set(h)}}},{key:"preparse",value:function(){this.allErrors=[],this.xmllexed=I.xmlparse(this.content,{text:this.fileTypeConfig.tagsXmlTextArray,other:this.fileTypeConfig.tagsXmlLexedArray}),this.setModules({inspect:{filePath:this.filePath,xmllexed:this.xmllexed}});var h=I.parse(this.xmllexed,this.delimiters,this.syntax,this.fileType),f=h.lexed,v=h.errors;R(this.allErrors,v),this.lexed=f,this.setModules({inspect:{filePath:this.filePath,lexed:this.lexed}});var l=this.getOptions();this.lexed=D.preparse(this.lexed,this.modules,l)}},{key:"parse",value:function(){var h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},f=h.noPostParse;this.setModules({inspect:{filePath:this.filePath}});var v=this.getOptions();return this.parsed=D.parse(this.lexed,this.modules,v),this.setModules({inspect:{filePath:this.filePath,parsed:this.parsed}}),f?this:this.postparse()}},{key:"postparse",value:function(){var h=this.getOptions(),f=D.postparse(this.parsed,this.modules,h),v=f.postparsed,l=f.errors;return this.postparsed=v,this.setModules({inspect:{filePath:this.filePath,postparsed:this.postparsed}}),R(this.allErrors,l),this.errorChecker(this.allErrors),this}},{key:"errorChecker",value:function(h){for(var f=0,v=h;f<v.length;f++){var l=v[f];l.properties||(l.properties={}),l.properties.file=this.filePath}for(var i=0,u=this.modules;i<u.length;i++){var x=u[i];h=x.errorsTransformer(h)}}},{key:"baseNullGetter",value:function(h,f){var v=this,l=this.modules.reduce(function(i,u){return i??u.nullGetter(h,f,v)},null);return l??this.nullGetter(h,f)}},{key:"getOptions",value:function(){return{compiled:this.postparsed,cachedParsers:this.cachedParsers,tags:this.tags,modules:this.modules,parser:this.parser,contentType:this.contentType,relsType:this.relsType,baseNullGetter:this.baseNullGetter.bind(this),filePath:this.filePath,fileTypeConfig:this.fileTypeConfig,fileType:this.fileType,linebreaks:this.linebreaks,stripInvalidXMLChars:this.stripInvalidXMLChars}}},{key:"render",value:function(h){this.filePath=h;var f=this.getOptions();f.resolved=this.scopeManager.resolved,f.scopeManager=this.scopeManager,f.render=X,f.joinUncorrupt=m;var v=X(f),l=v.errors,i=v.parts;return l.length>0?(this.allErrors=l,this.errorChecker(l),this):(this.content=V(i,f),this.setModules({inspect:{filePath:this.filePath,content:this.content}}),this)}}])}(),Ye}var Je,Ar;function rt(){if(Ar)return Je;Ar=1;function E(p){"@babel/helpers - typeof";return E=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(d){return typeof d}:function(d){return d&&typeof Symbol=="function"&&d.constructor===Symbol&&d!==Symbol.prototype?"symbol":typeof d},E(p)}function H(p,d){var g=Object.keys(p);if(Object.getOwnPropertySymbols){var F=Object.getOwnPropertySymbols(p);d&&(F=F.filter(function(k){return Object.getOwnPropertyDescriptor(p,k).enumerable})),g.push.apply(g,F)}return g}function L(p){for(var d=1;d<arguments.length;d++){var g=arguments[d]!=null?arguments[d]:{};d%2?H(Object(g),!0).forEach(function(F){O(p,F,g[F])}):Object.getOwnPropertyDescriptors?Object.defineProperties(p,Object.getOwnPropertyDescriptors(g)):H(Object(g)).forEach(function(F){Object.defineProperty(p,F,Object.getOwnPropertyDescriptor(g,F))})}return p}function O(p,d,g){return(d=X(d))in p?Object.defineProperty(p,d,{value:g,enumerable:!0,configurable:!0,writable:!0}):p[d]=g,p}function _(p,d){return q(p)||C(p,d)||M(p,d)||U()}function U(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function M(p,d){if(p){if(typeof p=="string")return R(p,d);var g={}.toString.call(p).slice(8,-1);return g==="Object"&&p.constructor&&(g=p.constructor.name),g==="Map"||g==="Set"?Array.from(p):g==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(g)?R(p,d):void 0}}function R(p,d){(d==null||d>p.length)&&(d=p.length);for(var g=0,F=Array(d);g<d;g++)F[g]=p[g];return F}function C(p,d){var g=p==null?null:typeof Symbol<"u"&&p[Symbol.iterator]||p["@@iterator"];if(g!=null){var F,k,r,t,e=[],o=!0,T=!1;try{if(r=(g=g.call(p)).next,d!==0)for(;!(o=(F=r.call(g)).done)&&(e.push(F.value),e.length!==d);o=!0);}catch(K){T=!0,k=K}finally{try{if(!o&&g.return!=null&&(t=g.return(),Object(t)!==t))return}finally{if(T)throw k}}return e}}function q(p){if(Array.isArray(p))return p}function B(p,d){if(!(p instanceof d))throw new TypeError("Cannot call a class as a function")}function I(p,d){for(var g=0;g<d.length;g++){var F=d[g];F.enumerable=F.enumerable||!1,F.configurable=!0,"value"in F&&(F.writable=!0),Object.defineProperty(p,X(F.key),F)}}function D(p,d,g){return d&&I(p.prototype,d),Object.defineProperty(p,"prototype",{writable:!1}),p}function X(p){var d=V(p,"string");return E(d)=="symbol"?d:d+""}function V(p,d){if(E(p)!="object"||!p)return p;var g=p[Symbol.toPrimitive];if(g!==void 0){var F=g.call(p,d);if(E(F)!="object")return F;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(p)}var Z=ve(),m=Z.chunkBy,y=Z.last,b=Z.isParagraphStart,c=Z.isModule,h=Z.pushArray,f=Z.isParagraphEnd,v=Z.isContent,l=Z.startsWith,i=Z.isTagEnd,u=Z.isTagStart,x=Z.getSingleAttribute,S=Z.setSingleAttribute,j=ir(),ee=Pe(),Q="loop";function G(p){return p.some(function(d){return v(d)})}function W(p){for(var d=0;d<p.length;d++){var g=p[d];if(g.type!=="content")return g}return null}function ne(p){var d=W(p.subparsed);return d!=null&&d.tag!=="w:t"}function ie(p){return p.hasPageBreak&&ne(p)?'<w:p><w:r><w:br w:type="page"/></w:r></w:p>':""}function se(p){return p.length&&b(p[0])&&f(y(p))}function ue(p){return G(p)?0:p.length}function fe(p){var d=p.parts.length-1;p.parts[d]==="</w:p>"?p.parts.splice(d,0,'<w:r><w:br w:type="page"/></w:r>'):p.parts.push('<w:p><w:r><w:br w:type="page"/></w:r></w:p>')}function A(p){p.parts.unshift('<w:p><w:r><w:br w:type="page"/></w:r></w:p>')}function N(p){return p.some(function(d){return u("w:type",d)&&d.value.indexOf("continuous")!==-1})}function a(p){return p.some(function(d){return u("w:type",d)&&d.value.indexOf('w:val="nextPage"')!==-1})}function n(p,d){return h(["<w:p><w:pPr>".concat(d.map(function(g){var F=g.value;return F}).join(""),"</w:pPr></w:p>")],p)}function s(p){var d=!1,g=!1;return p.reduce(function(F,k){return d===!1&&l(k,"<w:sectPr")&&(g=!0),g&&(l(k,"<w:type")&&(d=!0),d===!1&&l(k,"</w:sectPr")&&F.push('<w:type w:val="continuous"/>')),F.push(k),F},[])}function w(p){return p.filter(function(d){return!l(d,"<w:headerReference")&&!l(d,"<w:footerReference")})}function P(p){return p.some(function(d){return d.tag==="w:br"&&d.value.indexOf('w:type="page"')!==-1})}function z(p){return p.some(function(d){var g=d.tag;return g==="w:drawing"})}function J(p){for(var d=!1,g=[],F=0;F<p.length;F++){var k=p[F];u("w:sectPr",k)&&(g.push([]),d=!0),d&&g[g.length-1].push(k),i("w:sectPr",k)&&(d=!1)}return g}function $(p){for(var d=!1,g=0,F=0;F<p.length;F++){var k=p[F];u("w:sectPr",k)&&(d=!0),d&&(k.tag==="w:headerReference"||k.tag==="w:footerReference")&&(g++,d=!1),i("w:sectPr",k)&&(d=!1)}return g}function re(p){for(var d=[],g=!1,F=p.length-1;F>=0;F--){var k=p[F];if(i("w:sectPr",k)&&(g=!0),u("w:sectPr",k)&&(d.unshift(k.value),g=!1),g&&d.unshift(k.value),b(k)){if(d.length>0)return d.join("");break}}return""}var ae=function(){function p(){B(this,p),this.name="LoopModule",this.inXfrm=!1,this.totalSectPr=0,this.prefix={start:"#",end:"/",dash:/^-([^\s]+)\s(.+)/,inverted:"^"}}return D(p,[{key:"optionsTransformer",value:function(g,F){return this.docxtemplater=F,g}},{key:"preparse",value:function(g,F){var k=F.contentType;j.main.indexOf(k)!==-1&&(this.sects=J(g))}},{key:"matchers",value:function(){var g=Q;return[[this.prefix.start,g,{expandTo:"auto",location:"start",inverted:!1}],[this.prefix.inverted,g,{expandTo:"auto",location:"start",inverted:!0}],[this.prefix.end,g,{location:"end"}],[this.prefix.dash,g,function(F){var k=_(F,3),r=k[1],t=k[2];return{location:"start",inverted:!1,expandTo:r,value:t}}]]}},{key:"getTraits",value:function(g,F){if(g==="expandPair")return F.reduce(function(k,r,t){return c(r,Q)&&r.subparsed==null&&k.push({part:r,offset:t}),k},[])}},{key:"postparse",value:function(g,F){var k=F.basePart;if(k&&this.docxtemplater.fileType==="docx"&&g.length>0){k.sectPrCount=$(g),this.totalSectPr+=k.sectPrCount;var r=this.sects;r.some(function(te,oe){if(k.lIndex<te[0].lIndex)return oe+1<r.length&&N(r[oe+1])&&(k.addContinuousType=!0),!0;if(g[0].lIndex<te[0].lIndex&&te[0].lIndex<k.lIndex)return a(r[oe])&&(k.addNextPage={index:oe}),!0}),k.lastParagrapSectPr=re(g)}if(!k||k.expandTo!=="auto"||k.module!==Q||!se(g))return g;k.paragraphLoop=!0;var t=0,e=m(g,function(te){return b(te)&&(t++,t===1)?"start":f(te)&&(t--,t===0)?"end":null}),o=e[0],T=y(e),K=ue(o),Y=ue(T);return k.hasPageBreakBeginning=P(o),k.hasPageBreak=P(T),z(o)&&(K=0),z(T)&&(Y=0),g.slice(K,g.length-Y)}},{key:"resolve",value:function(g,F){if(!c(g,Q))return null;var k=F.scopeManager,r=k.getValueAsync(g.value,{part:g}),t=[];function e(T,K,Y){var te=k.createSubScopeManager(T,g.value,K,g,Y);t.push(F.resolve(L(L({},F),{},{compiled:g.subparsed,tags:{},scopeManager:te})))}var o=[];return r.then(function(T){return new Promise(function(K){T instanceof Array?Promise.all(T).then(K):K(T)}).then(function(K){return k.loopOverValue(K,e,g.inverted),Promise.all(t).then(function(Y){return Y.map(function(te){var oe=te.resolved,le=te.errors;return h(o,le),oe})}).then(function(Y){if(o.length>0)throw o;return Y})})})}},{key:"render",value:function(g,F){if(g.tag==="p:xfrm"&&(this.inXfrm=g.position==="start"),g.tag==="a:ext"&&this.inXfrm)return this.lastExt=g,g;if(!c(g,Q))return null;var k=[],r=[],t=0,e=this,o=g.subparsed[0],T=0;(o==null?void 0:o.tag)==="a:tr"&&(T=+x(o.value,"h")),t-=T;var K=0,Y=ne(g);function te(ce,pe,de){t+=T;for(var xe=F.scopeManager.createSubScopeManager(ce,g.value,pe,g,de),ge=0,ye=g.subparsed;ge<ye.length;ge++){var me=ye[ge];if(u("a16:rowId",me)){var we=+x(me.value,"val")+K;K=1,me.value=S(me.value,"val",we)}}var he=F.render(L(L({},F),{},{compiled:g.subparsed,tags:{},scopeManager:xe}));g.hasPageBreak&&pe===de-1&&Y&&fe(he);var Te=xe.scopePathItem.some(function(Oe){return Oe!==0});Te?(g.sectPrCount===1&&(he.parts=w(he.parts)),g.addContinuousType&&(he.parts=s(he.parts))):g.addNextPage&&(he.parts=n(he.parts,e.sects[g.addNextPage.index])),g.addNextPage&&fe(he),g.hasPageBreakBeginning&&Y&&A(he);for(var Se=0,Ee=he.parts;Se<Ee.length;Se++){var Ce=Ee[Se];k.push(Ce)}h(r,he.errors)}var oe=F.scopeManager.loopOver(g.value,te,g.inverted,{part:g});if(oe===!1)return g.lastParagrapSectPr?g.paragraphLoop?{value:"<w:p><w:pPr>".concat(g.lastParagrapSectPr,"</w:pPr></w:p>")}:{value:"</w:t></w:r></w:p><w:p><w:pPr>".concat(g.lastParagrapSectPr,"</w:pPr><w:r><w:t>")}:{value:ie(g)||"",errors:r};if(t!==0){var le=+x(this.lastExt.value,"cy");this.lastExt.value=S(this.lastExt.value,"cy",le+t)}return{value:F.joinUncorrupt(k,L(L({},F),{},{basePart:g})),errors:r}}}])}();return Je=function(){return ee(new ae)},Je}var Qe,Ir;function tt(){if(Ir)return Qe;Ir=1;function E(f){"@babel/helpers - typeof";return E=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(v){return typeof v}:function(v){return v&&typeof Symbol=="function"&&v.constructor===Symbol&&v!==Symbol.prototype?"symbol":typeof v},E(f)}function H(f,v){if(!(f instanceof v))throw new TypeError("Cannot call a class as a function")}function L(f,v){for(var l=0;l<v.length;l++){var i=v[l];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(f,_(i.key),i)}}function O(f,v,l){return v&&L(f.prototype,v),Object.defineProperty(f,"prototype",{writable:!1}),f}function _(f){var v=U(f,"string");return E(v)=="symbol"?v:v+""}function U(f,v){if(E(f)!="object"||!f)return f;var l=f[Symbol.toPrimitive];if(l!==void 0){var i=l.call(f,v);if(E(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(f)}var M=Pe(),R=ve(),C=R.isTextStart,q=R.isTextEnd,B=R.endsWith,I=R.startsWith,D=R.pushArray,X='<w:t xml:space="preserve">',V=X.length,Z="</w:t>",m=Z.length;function y(f){return C(f)&&f.tag==="w:t"}function b(f,v){var l=f[v].value;return f[v+1].value==="</w:t>"||l.indexOf('xml:space="preserve"')!==-1?l:l.substr(0,l.length-1)+' xml:space="preserve">'}function c(f,v){return f&&f.basePart&&v.length>1}var h=function(){function f(){H(this,f),this.name="SpacePreserveModule"}return O(f,[{key:"postparse",value:function(l,i){var u=[],x=!1,S=0,j=0;function ee(G,W){return G.type==="placeholder"&&W.length>1}var Q=l.reduce(function(G,W){return y(W)&&(x=!0,j=u.length),x?(u.push(W),c(i,u)&&(S=i.basePart.endLindex,u[0].value=b(u,0)),ee(W,u)&&(u[j].value=b(u,j),S=W.endLindex),q(W)&&W.lIndex>S&&(S!==0&&(u[j].value=b(u,j)),D(G,u),u=[],x=!1,S=0,j=0),G):(G.push(W),G)},[]);return D(Q,u),Q}},{key:"postrender",value:function(l){for(var i="",u=0,x=0,S=l.length;x<S;x++){var j=l[x];j!==""&&(B(i,X)&&I(j,Z)&&(l[u]=i.substr(0,i.length-V)+"<w:t/>",j=j.substr(m)),i=j,u=x,l[x]=j)}return l}}])}();return Qe=function(){return M(new h)},Qe}var $e,Mr;function nt(){if(Mr)return $e;Mr=1;function E(m){"@babel/helpers - typeof";return E=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(y){return typeof y}:function(y){return y&&typeof Symbol=="function"&&y.constructor===Symbol&&y!==Symbol.prototype?"symbol":typeof y},E(m)}function H(m,y){if(!(m instanceof y))throw new TypeError("Cannot call a class as a function")}function L(m,y){for(var b=0;b<y.length;b++){var c=y[b];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(m,_(c.key),c)}}function O(m,y,b){return y&&L(m.prototype,y),Object.defineProperty(m,"prototype",{writable:!1}),m}function _(m){var y=U(m,"string");return E(y)=="symbol"?y:y+""}function U(m,y){if(E(m)!="object"||!m)return m;var b=m[Symbol.toPrimitive];if(b!==void 0){var c=b.call(m,y);if(E(c)!="object")return c;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(m)}var M=ar(),R=ve(),C=R.isContent,q=be(),B=q.throwRawTagShouldBeOnlyTextInParagraph,I=q.getInvalidRawXMLValueException,D=Pe(),X="rawxml";function V(m){for(var y=m.part,b=m.left,c=m.right,h=m.postparsed,f=m.index,v=h.slice(b+1,c),l=0,i=v.length;l<i;l++)if(l!==f-b-1){var u=v[l];C(u)&&B({paragraphParts:v,part:y})}return y}var Z=function(){function m(){H(this,m),this.name="RawXmlModule",this.prefix="@"}return O(m,[{key:"optionsTransformer",value:function(b,c){return this.fileTypeConfig=c.fileTypeConfig,b}},{key:"matchers",value:function(){return[[this.prefix,X]]}},{key:"postparse",value:function(b){return M.expandToOne(b,{moduleName:X,getInner:V,expandTo:this.fileTypeConfig.tagRawXml,error:{message:"Raw tag not in paragraph",id:"raw_tag_outerxml_invalid",explanation:function(h){return'The tag "'.concat(h.value,'" is not inside a paragraph, putting raw tags inside an inline loop is disallowed.')}}})}},{key:"render",value:function(b,c){if(b.module!==X)return null;var h,f=[];try{h=c.scopeManager.getValue(b.value,{part:b}),h??(h=c.nullGetter(b))}catch(v){return f.push(v),{errors:f}}return h=h||"",typeof h=="string"?{value:h}:{errors:[I({tag:b.value,value:h,offset:b.offset})]}}}])}();return $e=function(){return D(new Z)},$e}var er,Lr;function ot(){if(Lr)return er;Lr=1;function E(H,L){for(var O=-1,_=0,U=H.length;_<U;_++)L[_]>=H[_].length||(O===-1||H[_][L[_]].offset<H[O][L[O]].offset)&&(O=_);return O}return er=function(H){var L=H.reduce(function(R,C){return R+C.length},0);H=H.filter(function(R){return R.length>0});for(var O=new Array(L),_=H.map(function(){return 0}),U=0;U<L;U++){var M=E(H,_);O[U]=H[M][_[M]],_[M]++}return O},er}var rr,Rr;function at(){if(Rr)return rr;Rr=1;function E(i){"@babel/helpers - typeof";return E=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(u){return typeof u}:function(u){return u&&typeof Symbol=="function"&&u.constructor===Symbol&&u!==Symbol.prototype?"symbol":typeof u},E(i)}function H(i,u){if(!(i instanceof u))throw new TypeError("Cannot call a class as a function")}function L(i,u){for(var x=0;x<u.length;x++){var S=u[x];S.enumerable=S.enumerable||!1,S.configurable=!0,"value"in S&&(S.writable=!0),Object.defineProperty(i,_(S.key),S)}}function O(i,u,x){return u&&L(i.prototype,u),Object.defineProperty(i,"prototype",{writable:!1}),i}function _(i){var u=U(i,"string");return E(u)=="symbol"?u:u+""}function U(i,u){if(E(i)!="object"||!i)return i;var x=i[Symbol.toPrimitive];if(x!==void 0){var S=x.call(i,u);if(E(S)!="object")return S;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(i)}var M="expandPair",R=ot(),C=ve(),q=C.getLeft,B=C.getRight,I=C.pushArray,D=Pe(),X=ar(),V=X.getExpandToDefault,Z=be(),m=Z.getUnmatchedLoopException,y=Z.getClosingTagNotMatchOpeningTag,b=Z.getUnbalancedLoopException;function c(i){switch(i.location){case"start":return 1;case"end":return-1}}function h(i,u){return i!=null&&u!=null&&(i.part.location==="start"&&u.part.location==="end"&&i.part.value===u.part.value||u.part.value==="")}function f(i){for(var u=0,x=[];u<i.length;){var S=i[u].part;if(S.location==="end"){if(u===0)return i.splice(0,1),x.push(m(S)),{traits:i,errors:x};var j=u,ee=u-1,Q=1;if(h(i[ee],i[j]))return i.splice(j,1),i.splice(ee,1),{errors:x,traits:i};for(;Q<50;){var G=i[ee-Q],W=i[j+Q];if(h(G,i[j]))return i.splice(j,1),i.splice(ee-Q,1),{errors:x,traits:i};if(h(i[ee],W))return i.splice(j+Q,1),i.splice(ee,1),{errors:x,traits:i};Q++}return x.push(y({tags:[i[ee].part,i[j].part]})),i.splice(j,1),i.splice(ee,1),{traits:i,errors:x}}u++}for(var ne=0;ne<i.length;ne++){var ie=i[ne].part;x.push(m(ie))}return{traits:[],errors:x}}function v(i){var u={},x=[],S=[],j=[];for(I(j,i);j.length>0;){var ee=f(j);I(x,ee.errors),j=ee.traits}if(x.length>0)return{pairs:S,errors:x};for(var Q=0,G=0;G<i.length;G++){var W=i[G],ne=W.part,ie=c(ne);if(Q+=ie,ie===1)u[Q]=W;else{var se=u[Q+1];Q===0&&S.push([se,W])}Q=Q>=0?Q:0}return{pairs:S,errors:x}}var l=function(){function i(){H(this,i),this.name="ExpandPairTrait"}return O(i,[{key:"optionsTransformer",value:function(x,S){return S.options.paragraphLoop&&I(S.fileTypeConfig.expandTags,S.fileTypeConfig.onParagraphLoop),this.expandTags=S.fileTypeConfig.expandTags,x}},{key:"postparse",value:function(x,S){var j=this,ee=S.getTraits,Q=S.postparse,G=S.fileType,W=ee(M,x);W=W.map(function(s){return s||[]}),W=R(W);var ne=v(W),ie=ne.pairs,se=ne.errors,ue=0,fe=null,A=ie.map(function(s){var w=s[0].part.expandTo;if(w==="auto"&&G!=="text"){var P=V(x,s,j.expandTags);P.error&&se.push(P.error),w=P.value}if(!w||G==="text"){var z=s[0].offset,J=s[1].offset;return z<ue&&!j.docxtemplater.options.syntax.allowUnbalancedLoops&&se.push(b(s,fe)),fe=s,ue=J,[z,J]}var $,re;try{$=q(x,w,s[0].offset)}catch(ae){se.push(ae)}try{re=B(x,w,s[1].offset)}catch(ae){se.push(ae)}return $<ue&&!j.docxtemplater.options.syntax.allowUnbalancedLoops&&se.push(b(s,fe)),ue=re,fe=s,[$,re]});if(se.length>0)return{postparsed:x,errors:se};var N=0,a,n=x.reduce(function(s,w,P){var z=N<ie.length&&A[N][0]<=P&&P<=A[N][1],J=ie[N],$=A[N];if(!z)return s.push(w),s;if($[0]===P&&(a=[]),J[0].offset!==P&&J[1].offset!==P&&a.push(w),$[1]===P){var re=x[J[0].offset];re.subparsed=Q(a,{basePart:re}),re.endLindex=J[1].part.lIndex,delete re.location,delete re.expandTo,s.push(re),N++;for(var ae=A[N];ae&&ae[0]<P;)N++,ae=A[N]}return s},[]);return{postparsed:n,errors:se}}}])}();return rr=function(){return D(new l)},rr}var tr,kr;function it(){if(kr)return tr;kr=1;function E(f){"@babel/helpers - typeof";return E=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(v){return typeof v}:function(v){return v&&typeof Symbol=="function"&&v.constructor===Symbol&&v!==Symbol.prototype?"symbol":typeof v},E(f)}function H(f,v){if(!(f instanceof v))throw new TypeError("Cannot call a class as a function")}function L(f,v){for(var l=0;l<v.length;l++){var i=v[l];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(f,_(i.key),i)}}function O(f,v,l){return v&&L(f.prototype,v),Object.defineProperty(f,"prototype",{writable:!1}),f}function _(f){var v=U(f,"string");return E(v)=="symbol"?v:v+""}function U(f,v){if(E(f)!="object"||!f)return f;var l=f[Symbol.toPrimitive];if(l!==void 0){var i=l.call(f,v);if(E(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(f)}var M=Pe(),R=be(),C=R.getScopeCompilationError,q=R.getCorruptCharactersException,B=ve(),I=B.utf8ToWord,D=B.hasCorruptCharacters,X=B.removeCorruptCharacters,V=Fr(),Z=V.settingsContentType,m=V.coreContentType,y=V.appContentType,b=V.customContentType,c={docx:"w",pptx:"a"},h=function(){function f(){H(this,f),this.name="Render",this.recordRun=!1,this.recordedRun=[]}return O(f,[{key:"optionsTransformer",value:function(l,i){return this.parser=i.parser,this.fileType=i.fileType,l}},{key:"set",value:function(l){l.compiled&&(this.compiled=l.compiled),l.data!=null&&(this.data=l.data)}},{key:"getRenderedMap",value:function(l){var i=this;return Object.keys(this.compiled).reduce(function(u,x){return u[x]={from:x,data:i.data},u},l)}},{key:"postparse",value:function(l,i){for(var u=[],x=0;x<l.length;x++){var S=l[x];if(S.type==="placeholder"){var j=S.value;try{i.cachedParsers[S.lIndex]=this.parser(j,{tag:S})}catch(ee){u.push(C({tag:j,rootError:ee,offset:S.offset}))}}}return{postparsed:l,errors:u}}},{key:"render",value:function(l,i){var u=i.contentType,x=i.scopeManager,S=i.linebreaks,j=i.nullGetter,ee=i.fileType,Q=i.stripInvalidXMLChars;if(S&&[Z,m,y,b].indexOf(u)!==-1&&(S=!1),S&&this.recordRuns(l),!(l.type!=="placeholder"||l.module)){var G;try{G=x.getValue(l.value,{part:l})}catch(W){return{errors:[W]}}if(G??(G=j(l)),typeof G=="string"){if(Q)G=X(G);else if(["docx","pptx","xlsx"].indexOf(ee)!==-1&&D(G))return{errors:[q({tag:l.value,value:G,offset:l.offset})]}}return ee==="text"?{value:G}:{value:S&&typeof G=="string"?this.renderLineBreaks(G):I(G)}}}},{key:"recordRuns",value:function(l){l.tag==="".concat(c[this.fileType],":r")?this.recordedRun=[]:l.tag==="".concat(c[this.fileType],":rPr")?(l.position==="start"&&(this.recordRun=!0,this.recordedRun=[l.value]),(l.position==="end"||l.position==="selfclosing")&&(this.recordedRun.push(l.value),this.recordRun=!1)):this.recordRun&&this.recordedRun.push(l.value)}},{key:"renderLineBreaks",value:function(l){var i=this,u=c[this.fileType],x=this.fileType==="docx"?"<w:r><w:br/></w:r>":"<a:br/>",S=l.split(`
`),j=this.recordedRun.join("");return S.map(function(ee){return I(ee)}).reduce(function(ee,Q,G){return ee.push(Q),G<S.length-1&&ee.push("</".concat(u,":t></").concat(u,":r>").concat(x,"<").concat(u,":r>").concat(j,"<").concat(u,":t").concat(i.fileType==="docx"?' xml:space="preserve"':"",">")),ee},[])}}])}();return tr=function(){return M(new h)},tr}var nr,Dr;function st(){if(Dr)return nr;Dr=1;var E=rt(),H=tt(),L=nt(),O=at(),_=it();function U(){return{getTemplatedFiles:function(){return[]},textPath:function(C){return C.textTarget},tagsXmlTextArray:["Company","HyperlinkBase","Manager","cp:category","cp:keywords","dc:creator","dc:description","dc:subject","dc:title","cp:contentStatus","w:t","a:t","m:t","vt:lpstr","vt:lpwstr"],tagsXmlLexedArray:["w:proofState","w:tc","w:tr","w:tbl","w:body","w:document","w:p","w:r","w:br","w:rPr","w:pPr","w:spacing","w:sdtContent","w:sdt","w:drawing","w:sectPr","w:type","w:headerReference","w:footerReference","w:bookmarkStart","w:bookmarkEnd","w:commentRangeStart","w:commentRangeEnd","w:commentReference"],droppedTagsInsidePlaceholder:["w:p","w:br","w:bookmarkStart","w:bookmarkEnd"],expandTags:[{contains:"w:tc",expand:"w:tr"}],onParagraphLoop:[{contains:"w:p",expand:"w:p",onlyTextInTag:!0}],tagRawXml:"w:p",baseModules:[E,H,O,L,_],tagShouldContain:[{tag:"w:sdtContent",shouldContain:["w:p","w:r","w:commentRangeStart","w:sdt"],value:"<w:p></w:p>"},{tag:"w:tc",shouldContain:["w:p"],value:"<w:p></w:p>"},{tag:"w:tr",shouldContain:["w:tc"],drop:!0},{tag:"w:tbl",shouldContain:["w:tr"],drop:!0}]}}function M(){return{getTemplatedFiles:function(){return[]},textPath:function(C){return C.textTarget},tagsXmlTextArray:["Company","HyperlinkBase","Manager","cp:category","cp:keywords","dc:creator","dc:description","dc:subject","dc:title","a:t","m:t","vt:lpstr","vt:lpwstr"],tagsXmlLexedArray:["p:sp","a:tc","a:tr","a:tbl","a:graphicData","a:p","a:r","a:rPr","p:txBody","a:txBody","a:off","a:ext","p:graphicFrame","p:xfrm","a16:rowId","a:endParaRPr"],droppedTagsInsidePlaceholder:["a:p","a:endParaRPr"],expandTags:[{contains:"a:tc",expand:"a:tr"}],onParagraphLoop:[{contains:"a:p",expand:"a:p",onlyTextInTag:!0}],tagRawXml:"p:sp",baseModules:[E,O,L,_],tagShouldContain:[{tag:"a:tbl",shouldContain:["a:tr"],dropParent:"p:graphicFrame"},{tag:"p:txBody",shouldContain:["a:p"],value:"<a:p></a:p>"},{tag:"a:txBody",shouldContain:["a:p"],value:"<a:p></a:p>"}]}}return nr={docx:U,pptx:M},nr}var qr;function lt(){return qr||(qr=1,function(E){var H=["modules"];function L(r,t){var e=Object.keys(r);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(r);t&&(o=o.filter(function(T){return Object.getOwnPropertyDescriptor(r,T).enumerable})),e.push.apply(e,o)}return e}function O(r){for(var t=1;t<arguments.length;t++){var e=arguments[t]!=null?arguments[t]:{};t%2?L(Object(e),!0).forEach(function(o){_(r,o,e[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(e)):L(Object(e)).forEach(function(o){Object.defineProperty(r,o,Object.getOwnPropertyDescriptor(e,o))})}return r}function _(r,t,e){return(t=y(t))in r?Object.defineProperty(r,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):r[t]=e,r}function U(r,t){return B(r)||q(r,t)||R(r,t)||M()}function M(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function R(r,t){if(r){if(typeof r=="string")return C(r,t);var e={}.toString.call(r).slice(8,-1);return e==="Object"&&r.constructor&&(e=r.constructor.name),e==="Map"||e==="Set"?Array.from(r):e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?C(r,t):void 0}}function C(r,t){(t==null||t>r.length)&&(t=r.length);for(var e=0,o=Array(t);e<t;e++)o[e]=r[e];return o}function q(r,t){var e=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(e!=null){var o,T,K,Y,te=[],oe=!0,le=!1;try{if(K=(e=e.call(r)).next,t===0){if(Object(e)!==e)return;oe=!1}else for(;!(oe=(o=K.call(e)).done)&&(te.push(o.value),te.length!==t);oe=!0);}catch(ce){le=!0,T=ce}finally{try{if(!oe&&e.return!=null&&(Y=e.return(),Object(Y)!==Y))return}finally{if(le)throw T}}return te}}function B(r){if(Array.isArray(r))return r}function I(r){"@babel/helpers - typeof";return I=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},I(r)}function D(r,t){if(r==null)return{};var e,o,T=X(r,t);if(Object.getOwnPropertySymbols){var K=Object.getOwnPropertySymbols(r);for(o=0;o<K.length;o++)e=K[o],t.indexOf(e)===-1&&{}.propertyIsEnumerable.call(r,e)&&(T[e]=r[e])}return T}function X(r,t){if(r==null)return{};var e={};for(var o in r)if({}.hasOwnProperty.call(r,o)){if(t.indexOf(o)!==-1)continue;e[o]=r[o]}return e}function V(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function Z(r,t){for(var e=0;e<t.length;e++){var o=t[e];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(r,y(o.key),o)}}function m(r,t,e){return t&&Z(r.prototype,t),Object.defineProperty(r,"prototype",{writable:!1}),r}function y(r){var t=b(r,"string");return I(t)=="symbol"?t:t+""}function b(r,t){if(I(r)!="object"||!r)return r;var e=r[Symbol.toPrimitive];if(e!==void 0){var o=e.call(r,t);if(I(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(r)}var c=ve();c.traits=ar(),c.moduleWrapper=Pe();var h=Wr(),f=Vr(),v=Xr(),l=zr(),i=l.getTags,u=Gr(),x=Kr(),S=be(),j=S.throwMultiError,ee=S.throwResolveBeforeCompile,Q=S.throwRenderInvalidTemplate,G=S.throwRenderTwice,W=S.XTInternalError,ne=S.XTTemplateError,ie=S.throwFileTypeNotIdentified,se=S.throwFileTypeNotHandled,ue=S.throwApiVersionError,fe=c.getDefaults,A=c.str2xml,N=c.xml2str,a=c.moduleWrapper,n=c.concatArrays,s=c.uniq,w=c.getDuplicates,P=c.stableSort,z=c.pushArray,J="[Content_Types].xml",$="_rels/.rels",re=[3,46,0];function ae(r){var t=[];for(var e in r)t.push(e);for(var o=[J,$],T=["word/","xl/","ppt/"],K=0;K<t.length;K++)for(var Y=t[K],te=0;te<T.length;te++){var oe=T[te];Y.indexOf("".concat(oe))===0&&o.push(Y)}for(var le=0;le<t.length;le++){var ce=t[le];o.indexOf(ce)===-1&&o.push(ce)}return o}function p(r,t){r.hideDeprecations!==!0&&console.warn(t)}function d(r,t){if(r.hideDeprecations!==!0)return p(r,'Deprecated method ".'.concat(t,'", view upgrade guide : https://docxtemplater.com/docs/api/#upgrade-guide, stack : ').concat(new Error().stack))}function g(r){r.modules=r.modules.filter(function(t){if(!t.supportedFileTypes)return!0;if(!Array.isArray(t.supportedFileTypes))throw new Error("The supportedFileTypes field of the module must be an array");var e=t.supportedFileTypes.includes(r.fileType);return e||t.on("detached"),e})}function F(r){var t=r.compiled;r.errors=n(Object.keys(t).map(function(e){return t[e].allErrors})),r.errors.length!==0&&(r.options.errorLogging&&u(r.errors,r.options.errorLogging),j(r.errors))}var k=function(){function r(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=e.modules,T=o===void 0?[]:o,K=D(e,H);if(V(this,r),this.targets=[],this.rendered=!1,this.scopeManagers={},this.compiled={},this.modules=[h()],this.xmlDocuments={},arguments.length===0)p(this,"Deprecated docxtemplater constructor with no arguments, view upgrade guide : https://docxtemplater.com/docs/api/#upgrade-guide, stack : ".concat(new Error().stack)),this.hideDeprecations=!0,this.setOptions(K);else{if(this.hideDeprecations=!0,this.setOptions(K),!t||!t.files||typeof t.file!="function")throw new Error("The first argument of docxtemplater's constructor must be a valid zip file (jszip v2 or pizzip v3)");if(!Array.isArray(T))throw new Error("The modules argument of docxtemplater's constructor must be an array");for(var Y=0;Y<T.length;Y++){var te=T[Y];this.attachModule(te)}this.loadZip(t),this.compile(),this.v4Constructor=!0}this.hideDeprecations=!1}return m(r,[{key:"verifyApiVersion",value:function(e){return e=e.split(".").map(function(o){return parseInt(o,10)}),e.length!==3&&ue("neededVersion is not a valid version",{neededVersion:e,explanation:"the neededVersion must be an array of length 3"}),e[0]!==re[0]&&ue("The major api version do not match, you probably have to update docxtemplater with npm install --save docxtemplater",{neededVersion:e,currentModuleApiVersion:re,explanation:"moduleAPIVersionMismatch : needed=".concat(e.join("."),", current=").concat(re.join("."))}),e[1]>re[1]&&ue("The minor api version is not uptodate, you probably have to update docxtemplater with npm install --save docxtemplater",{neededVersion:e,currentModuleApiVersion:re,explanation:"moduleAPIVersionMismatch : needed=".concat(e.join("."),", current=").concat(re.join("."))}),e[1]===re[1]&&e[2]>re[2]&&ue("The patch api version is not uptodate, you probably have to update docxtemplater with npm install --save docxtemplater",{neededVersion:e,currentModuleApiVersion:re,explanation:"moduleAPIVersionMismatch : needed=".concat(e.join("."),", current=").concat(re.join("."))}),!0}},{key:"setModules",value:function(e){for(var o=0,T=this.modules;o<T.length;o++){var K=T[o];K.set(e)}}},{key:"sendEvent",value:function(e){for(var o=0,T=this.modules;o<T.length;o++){var K=T[o];K.on(e)}}},{key:"attachModule",value:function(e){if(this.v4Constructor)throw new W("attachModule() should not be called manually when using the v4 constructor");d(this,"attachModule");var o=I(e);if(o==="function")throw new W("Cannot attach a class/function as a module. Most probably you forgot to instantiate the module by using `new` on the module.");if(!e||o!=="object")throw new W("Cannot attachModule with a falsy value");if(e.requiredAPIVersion&&this.verifyApiVersion(e.requiredAPIVersion),e.attached===!0)if(typeof e.clone=="function")e=e.clone();else throw new Error('Cannot attach a module that was already attached : "'.concat(e.name,'". The most likely cause is that you are instantiating the module at the root level, and using it for multiple instances of Docxtemplater'));e.attached=!0;var T=a(e);return this.modules.push(T),T.on("attached"),this.fileType&&g(this),this}},{key:"setOptions",value:function(e){var o,T;if(this.v4Constructor)throw new Error("setOptions() should not be called manually when using the v4 constructor");if(d(this,"setOptions"),!e)throw new Error("setOptions should be called with an object as first parameter");this.options={};var K=fe();for(var Y in K){var te=K[Y];this.options[Y]=e[Y]!=null?e[Y]:this[Y]||te,this[Y]=this.options[Y]}return(o=this.delimiters).start&&(o.start=c.utf8ToWord(this.delimiters.start)),(T=this.delimiters).end&&(T.end=c.utf8ToWord(this.delimiters.end)),this}},{key:"loadZip",value:function(e){if(this.v4Constructor)throw new Error("loadZip() should not be called manually when using the v4 constructor");if(d(this,"loadZip"),e.loadAsync)throw new W("Docxtemplater doesn't handle JSZip version >=3, please use pizzip");this.zip=e,this.updateFileTypeConfig(),this.modules=n([this.fileTypeConfig.baseModules.map(function(Y){return Y()}),this.modules]);for(var o=0,T=this.modules;o<T.length;o++){var K=T[o];K.zip=this.zip,K.docxtemplater=this}return g(this),this}},{key:"precompileFile",value:function(e){var o=this.createTemplateClass(e);o.preparse(),this.compiled[e]=o}},{key:"compileFile",value:function(e){this.compiled[e].parse()}},{key:"getScopeManager",value:function(e,o,T){var K;return(K=this.scopeManagers)[e]||(K[e]=f({tags:T,parser:this.parser,cachedParsers:o.cachedParsers})),this.scopeManagers[e]}},{key:"resolveData",value:function(e){var o=this;d(this,"resolveData");var T=[];return Object.keys(this.compiled).length||ee(),Promise.resolve(e).then(function(K){return o.data=K,o.setModules({data:o.data,Lexer:v}),o.mapper=o.modules.reduce(function(Y,te){return te.getRenderedMap(Y)},{}),Promise.all(Object.keys(o.mapper).map(function(Y){var te=o.mapper[Y],oe=te.from,le=te.data;return Promise.resolve(le).then(function(ce){var pe=o.compiled[oe];return pe.filePath=Y,pe.scopeManager=o.getScopeManager(Y,pe,ce),pe.resolveTags(ce).then(function(de){return pe.scopeManager.finishedResolving=!0,de},function(de){z(T,de)})})})).then(function(Y){return T.length!==0&&(o.options.errorLogging&&u(T,o.options.errorLogging),j(T)),n(Y)})})}},{key:"reorderModules",value:function(){this.modules=P(this.modules,function(e,o){return(o.priority||0)-(e.priority||0)})}},{key:"throwIfDuplicateModules",value:function(){var e=w(this.modules.map(function(o){var T=o.name;return T}));if(e.length>0)throw new W('Detected duplicate module "'.concat(e[0],'"'))}},{key:"compile",value:function(){var e=this;if(d(this,"compile"),this.updateFileTypeConfig(),this.throwIfDuplicateModules(),this.reorderModules(),Object.keys(this.compiled).length)return this;this.options=this.modules.reduce(function(me,we){return we.optionsTransformer(me,e)},this.options),this.options.xmlFileNames=s(this.options.xmlFileNames);for(var o=0,T=this.options.xmlFileNames;o<T.length;o++){var K=T[o],Y=this.zip.files[K].asText();this.xmlDocuments[K]=A(Y)}this.setModules({zip:this.zip,xmlDocuments:this.xmlDocuments}),this.getTemplatedFiles(),this.sendEvent("before-preparse");for(var te=0,oe=this.templatedFiles;te<oe.length;te++){var le=oe[te];this.zip.files[le]!=null&&this.precompileFile(le)}this.sendEvent("after-preparse");for(var ce=0,pe=this.templatedFiles;ce<pe.length;ce++){var de=pe[ce];this.zip.files[de]!=null&&this.compiled[de].parse({noPostParse:!0})}this.sendEvent("after-parse");for(var xe=0,ge=this.templatedFiles;xe<ge.length;xe++){var ye=ge[xe];this.zip.files[ye]!=null&&this.compiled[ye].postparse()}return this.sendEvent("after-postparse"),this.setModules({compiled:this.compiled}),F(this),this}},{key:"getRelsTypes",value:function(){for(var e=this.zip.files[$],o=e?A(e.asText()):null,T=o?o.getElementsByTagName("Relationship"):[],K={},Y=0;Y<T.length;Y++){var te=T[Y];K[te.getAttribute("Target")]=te.getAttribute("Type")}return K}},{key:"getContentTypes",value:function(){var e=this.zip.files[J],o=e?A(e.asText()):null,T=o?o.getElementsByTagName("Override"):null,K=o?o.getElementsByTagName("Default"):null;return{overrides:T,defaults:K,contentTypes:e,contentTypeXml:o}}},{key:"updateFileTypeConfig",value:function(){this.relsTypes=this.getRelsTypes();var e=this.getContentTypes(),o=e.overrides,T=e.defaults,K=e.contentTypes,Y=e.contentTypeXml;Y&&(this.filesContentTypes=x(o,T,this.zip),this.invertedContentTypes=c.invertMap(this.filesContentTypes),this.setModules({contentTypes:this.contentTypes,invertedContentTypes:this.invertedContentTypes}));var te;this.zip.files.mimetype&&(te="odt");for(var oe=0,le=this.modules;oe<le.length;oe++){var ce=le[oe];te=ce.getFileType({zip:this.zip,contentTypes:K,contentTypeXml:Y,overrides:o,defaults:T,doc:this})||te}te==="odt"&&se(te),te||ie(this.zip);for(var pe=0,de=this.modules;pe<de.length;pe++)for(var xe=de[pe],ge=0,ye=xe.xmlContentTypes||[];ge<ye.length;ge++){var me=ye[ge];z(this.options.xmlFileNames,this.invertedContentTypes[me]||[])}if(this.fileType=te,g(this),this.fileTypeConfig=this.options.fileTypeConfig||this.fileTypeConfig,!this.fileTypeConfig)if(r.FileTypeConfig[this.fileType])this.fileTypeConfig=r.FileTypeConfig[this.fileType]();else{var we='Filetype "'.concat(this.fileType,'" is not supported'),he="filetype_not_supported";this.fileType==="xlsx"&&(we='Filetype "'.concat(this.fileType,'" is supported only with the paid XlsxModule'),he="xlsx_filetype_needs_xlsx_module");var Te=new ne(we);throw Te.properties={id:he,explanation:we},Te}return this}},{key:"renderAsync",value:function(e){var o=this;this.hideDeprecations=!0;var T=this.resolveData(e);return this.hideDeprecations=!1,T.then(function(){return o.render()})}},{key:"render",value:function(e){this.rendered&&G(),this.rendered=!0,Object.keys(this.compiled).length===0&&this.compile(),this.errors.length>0&&Q(),arguments.length>0&&(this.data=e),this.setModules({data:this.data,Lexer:v}),this.mapper||(this.mapper=this.modules.reduce(function(Ce,Oe){return Oe.getRenderedMap(Ce)},{}));var o=[];for(var T in this.mapper){var K=this.mapper[T],Y=K.from,te=K.data,oe=this.compiled[Y];oe.scopeManager=this.getScopeManager(T,oe,te),oe.render(T),o.push([T,oe.content,oe]),delete oe.content}for(var le=0;le<o.length;le++)for(var ce=o[le],pe=U(ce,3),de=pe[1],xe=pe[2],ge=0,ye=this.modules;ge<ye.length;ge++){var me=ye[ge];if(me.preZip){var we=me.preZip(de,xe);typeof we=="string"&&(ce[1]=we)}}for(var he=0;he<o.length;he++){var Te=U(o[he],2),Se=Te[0],Ee=Te[1];this.zip.file(Se,Ee,{createFolders:!0})}return F(this),this.sendEvent("syncing-zip"),this.syncZip(),this.sendEvent("synced-zip"),this}},{key:"syncZip",value:function(){for(var e in this.xmlDocuments){this.zip.remove(e);var o=N(this.xmlDocuments[e]);this.zip.file(e,o,{createFolders:!0})}}},{key:"setData",value:function(e){return d(this,"setData"),this.data=e,this}},{key:"getZip",value:function(){return this.zip}},{key:"createTemplateClass",value:function(e){var o=this.zip.files[e].asText();return this.createTemplateClassFromContent(o,e)}},{key:"createTemplateClassFromContent",value:function(e,o){for(var T={filePath:o,contentType:this.filesContentTypes[o],relsType:this.relsTypes[o]},K=fe(),Y=z(Object.keys(K),["filesContentTypes","fileTypeConfig","fileType","modules"]),te=0;te<Y.length;te++){var oe=Y[te];T[oe]=this[oe]}return new r.XmlTemplater(e,T)}},{key:"getFullText",value:function(e){return this.createTemplateClass(e||this.fileTypeConfig.textPath(this)).getFullText()}},{key:"getTemplatedFiles",value:function(){return this.templatedFiles=this.fileTypeConfig.getTemplatedFiles(this.zip),z(this.templatedFiles,this.targets),this.templatedFiles=s(this.templatedFiles),this.templatedFiles}},{key:"getTags",value:function(){var e={headers:[],footers:[]};for(var o in this.compiled){var T=this.filesContentTypes[o];T==="application/vnd.openxmlformats-officedocument.wordprocessingml.document.main+xml"&&(e.document={target:o,tags:i(this.compiled[o].postparsed)}),T==="application/vnd.openxmlformats-officedocument.wordprocessingml.header+xml"&&e.headers.push({target:o,tags:i(this.compiled[o].postparsed)}),T==="application/vnd.openxmlformats-officedocument.wordprocessingml.footer+xml"&&e.footers.push({target:o,tags:i(this.compiled[o].postparsed)})}return e}},{key:"toBuffer",value:function(e){return this.getZip().generate(O(O({compression:"DEFLATE",fileOrder:ae},e),{},{type:"nodebuffer"}))}},{key:"toBlob",value:function(e){return this.getZip().generate(O(O({compression:"DEFLATE",fileOrder:ae},e),{},{type:"blob"}))}},{key:"toBase64",value:function(e){return this.getZip().generate(O(O({compression:"DEFLATE",fileOrder:ae},e),{},{type:"base64"}))}},{key:"toUint8Array",value:function(e){return this.getZip().generate(O(O({compression:"DEFLATE",fileOrder:ae},e),{},{type:"uint8array"}))}},{key:"toArrayBuffer",value:function(e){return this.getZip().generate(O(O({compression:"DEFLATE",fileOrder:ae},e),{},{type:"arraybuffer"}))}}])}();k.DocUtils=c,k.Errors=be(),k.XmlTemplater=et(),k.FileTypeConfig=st(),k.XmlMatcher=Nr(),E.exports=k,E.exports.default=k}(je)),je.exports}var ut=lt();const ct=Br(ut);export{ct as D};
